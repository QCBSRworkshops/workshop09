<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Correspondence Analysis | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Correspondence Analysis | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Correspondence Analysis | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="principal-component-analysis.html"/>
<link rel="next" href="principal-coordinates-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>PREAMBLE</b></span></li>
<li class="chapter" data-level="3" data-path="recap-univariate-analyses.html"><a href="recap-univariate-analyses.html"><i class="fa fa-check"></i><b>3</b> Recap: Univariate analyses</a></li>
<li class="chapter" data-level="4" data-path="intro-multivariate-analyses.html"><a href="intro-multivariate-analyses.html"><i class="fa fa-check"></i><b>4</b> Intro: Multivariate analyses</a></li>
<li class="chapter" data-level="5" data-path="setting-up-our-goals.html"><a href="setting-up-our-goals.html"><i class="fa fa-check"></i><b>5</b> Setting up our goals</a></li>
<li class="chapter" data-level="6" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html"><i class="fa fa-check"></i><b>6</b> Matrix algebra, very briefly</a>
<ul>
<li class="chapter" data-level="6.1" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#data-sets-are-matrices"><i class="fa fa-check"></i><b>6.1</b> Data sets <em>are</em> matrices</a></li>
<li class="chapter" data-level="6.2" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#association-matrices"><i class="fa fa-check"></i><b>6.2</b> Association matrices</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>7</b> Exploring the dataset</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-fish-communities"><i class="fa fa-check"></i><b>7.1</b> Doubs river fish communities</a></li>
<li class="chapter" data-level="7.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-environmental-data"><i class="fa fa-check"></i><b>7.2</b> Doubs river environmental data</a></li>
</ul></li>
<li class="part"><span><b>(Dis)similarity measures</b></span></li>
<li class="chapter" data-level="8" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>8</b> <code>dist()</code></a></li>
<li class="chapter" data-level="9" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html"><i class="fa fa-check"></i><b>9</b> Types of distance coefficients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#metric-distances"><i class="fa fa-check"></i><b>9.1</b> Metric distances</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#euclidean-distances"><i class="fa fa-check"></i><b>9.1.1</b> Euclidean distances</a></li>
<li class="chapter" data-level="9.1.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#challenge-1"><i class="fa fa-check"></i><b>9.1.2</b> Challenge #1</a></li>
<li class="chapter" data-level="9.1.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#chord-distances"><i class="fa fa-check"></i><b>9.1.3</b> Chord distances</a></li>
<li class="chapter" data-level="9.1.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#jaccards-coefficient"><i class="fa fa-check"></i><b>9.1.4</b> Jaccard’s coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#semimetric-distances"><i class="fa fa-check"></i><b>9.2</b> Semimetric distances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#sørensens-coefficient"><i class="fa fa-check"></i><b>9.2.1</b> Sørensen’s coefficient</a></li>
<li class="chapter" data-level="9.2.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#bray-curtis-coefficient"><i class="fa fa-check"></i><b>9.2.2</b> Bray-Curtis’ coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#nonmetric-distances"><i class="fa fa-check"></i><b>9.3</b> Nonmetric distances</a></li>
<li class="chapter" data-level="9.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#representation"><i class="fa fa-check"></i><b>9.4</b> Representation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>10</b> Transformations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transformations.html"><a href="transformations.html#presence-absence-transformation"><i class="fa fa-check"></i><b>10.1</b> Presence-absence transformation</a></li>
<li class="chapter" data-level="10.2" data-path="transformations.html"><a href="transformations.html#species-profiles-transformation"><i class="fa fa-check"></i><b>10.2</b> Species profiles transformation</a></li>
<li class="chapter" data-level="10.3" data-path="transformations.html"><a href="transformations.html#hellinger-transformation"><i class="fa fa-check"></i><b>10.3</b> Hellinger transformation</a></li>
<li class="chapter" data-level="10.4" data-path="transformations.html"><a href="transformations.html#z-score-standardization"><i class="fa fa-check"></i><b>10.4</b> Z-score standardization</a></li>
</ul></li>
<li class="part"><span><b>Clustering</b></span></li>
<li class="chapter" data-level="11" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>11</b> Clustering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clustering.html"><a href="clustering.html#single-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.1</b> Single linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.2" data-path="clustering.html"><a href="clustering.html#complete-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.2</b> Complete linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.3" data-path="clustering.html"><a href="clustering.html#wards-minimum-variance-clustering"><i class="fa fa-check"></i><b>11.3</b> Ward’s minimum variance clustering</a></li>
</ul></li>
<li class="part"><span><b>Unconstrained Ordination</b></span></li>
<li class="chapter" data-level="12" data-path="what-does-unconstrained-mean.html"><a href="what-does-unconstrained-mean.html"><i class="fa fa-check"></i><b>12</b> What does “unconstrained” mean?</a></li>
<li class="chapter" data-level="13" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="14" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>14</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="15" data-path="principal-coordinates-analysis.html"><a href="principal-coordinates-analysis.html"><i class="fa fa-check"></i><b>15</b> Principal Coordinates Analysis</a></li>
<li class="chapter" data-level="16" data-path="nonmetric-multidimensional-scaling.html"><a href="nonmetric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>16</b> Nonmetric MultiDimensional Scaling</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="17" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>17</b> Summary</a></li>
<li class="chapter" data-level="18" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18</b> Additional resources</a></li>
<li class="chapter" data-level="19" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>19</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="correspondence-analysis" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Correspondence Analysis<a href="correspondence-analysis.html#correspondence-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One of the key assumptions made in PCA is that species are related to
each other linearly and that they respond linearly to ecological
gradients. This is not necessarily the case with a lot of ecological
data (e.g. many species have unimodal species distributions). Using PCA
on data with unimodal species distributions or a lot of zero values may
lead to a phenomenon called the “horseshoe effect”, and can occur with
long ecological gradients. As such, a CA or Correspondence Analysis may
be a better option for this type of data, see Legendre and Legendre
(2012) for further information. As CA preserves Chi2 distances (while
PCA preserves Euclidean distances), this technique is indeed better
suited to ordinate datasets containing unimodal species distributions,
and has, for a long time, been one of the favourite tools for the
analysis of species presence–absence or abundance data. In CA, the raw
data are first transformed into a matrix Q of cell-by-cell contributions
to the Pearson Chi2 statistic, and the resulting table is submitted to a
singular value decomposition to compute its eigenvalues and
eigenvectors. The result is an ordination, where it is the Chi2 distance
that is preserved among sites instead of the Euclidean distance in PCA.
The Chi2 distance is not influenced by the double zeros. Therefore, CA
is a method adapted to the analysis of species abundance data without
pre-transformation. Contrary to PCA, CA can also be applied to analyze
both quantitative and binary data (such as species abundances or
absence/presence). As in PCA, the Kaiser-Guttman criterion can be
applied to determine the significant axes of a CA, and ordination axes
can be extracted to be used in multiples regressions.</p>
<p>Run a CA on species data:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="correspondence-analysis.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the CA using the cca() function (NB: cca() is used</span></span>
<span id="cb112-2"><a href="correspondence-analysis.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for both CA and CCA)</span></span>
<span id="cb112-3"><a href="correspondence-analysis.html#cb112-3" aria-hidden="true" tabindex="-1"></a>spe.ca <span class="ot">&lt;-</span> <span class="fu">cca</span>(spe)</span>
<span id="cb112-4"><a href="correspondence-analysis.html#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="correspondence-analysis.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the significant axes</span></span>
<span id="cb112-6"><a href="correspondence-analysis.html#cb112-6" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb112-7"><a href="correspondence-analysis.html#cb112-7" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb112-8"><a href="correspondence-analysis.html#cb112-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(ev)</span>
<span id="cb112-9"><a href="correspondence-analysis.html#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb112-10"><a href="correspondence-analysis.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb112-11"><a href="correspondence-analysis.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="/ca_guttmankaiser.png" class="align-center" /></p>
<p>From this barplot, you can see that once you reach C6, the proportion of
variance explained falls below the average proportion explained by the
other components. If you take another look at the CA summary, you will
notice that by the time you reach CA5, the cumulative proportion of
variance explained by the principal components is 84.63%.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="correspondence-analysis.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spe.h.pca)  <span class="co">#overall results</span></span>
<span id="cb113-2"><a href="correspondence-analysis.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spe.h.pca, <span class="at">diplay =</span> <span class="cn">NULL</span>)  <span class="co"># only axis eigenvalues and contribution</span></span></code></pre></div>
<p><img src="/ca_summary.png" class="align-center" /></p>
<p>CA results are presented in a similar manner as PCA results. You can see
here that CA1 explains 51.50% of the variation in species abundances,
while CA2 explain 12.37% of the variation.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="correspondence-analysis.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb114-2"><a href="correspondence-analysis.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### scaling 1</span></span>
<span id="cb114-3"><a href="correspondence-analysis.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.ca, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>, <span class="at">main =</span> <span class="st">&quot;CA - biplot scaling 1&quot;</span>,</span>
<span id="cb114-4"><a href="correspondence-analysis.html#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;CA1 (%)&quot;</span>, <span class="fu">round</span>((spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb114-5"><a href="correspondence-analysis.html#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="dv">2</span>)), <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;CA2 (%)&quot;</span>, <span class="fu">round</span>((spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb114-6"><a href="correspondence-analysis.html#cb114-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="dv">2</span>)))</span>
<span id="cb114-7"><a href="correspondence-analysis.html#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="correspondence-analysis.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">1</span>),</span>
<span id="cb114-9"><a href="correspondence-analysis.html#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb114-10"><a href="correspondence-analysis.html#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="correspondence-analysis.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">scaling =</span> <span class="dv">1</span>),</span>
<span id="cb114-12"><a href="correspondence-analysis.html#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">1</span>),</span>
<span id="cb114-13"><a href="correspondence-analysis.html#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">scaling =</span> <span class="dv">1</span>)),</span>
<span id="cb114-14"><a href="correspondence-analysis.html#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-15"><a href="correspondence-analysis.html#cb114-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-16"><a href="correspondence-analysis.html#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="do">#### scaling 2</span></span>
<span id="cb114-17"><a href="correspondence-analysis.html#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.ca, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>, <span class="at">main =</span> <span class="st">&quot;CA - biplot scaling 2&quot;</span>,</span>
<span id="cb114-18"><a href="correspondence-analysis.html#cb114-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;CA1 (%)&quot;</span>, <span class="fu">round</span>((spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb114-19"><a href="correspondence-analysis.html#cb114-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="dv">2</span>)), <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;CA2 (%)&quot;</span>, <span class="fu">round</span>((spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb114-20"><a href="correspondence-analysis.html#cb114-20" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="dv">2</span>)), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb114-21"><a href="correspondence-analysis.html#cb114-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-22"><a href="correspondence-analysis.html#cb114-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">2</span>),</span>
<span id="cb114-23"><a href="correspondence-analysis.html#cb114-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb114-24"><a href="correspondence-analysis.html#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">scaling =</span> <span class="dv">2</span>),</span>
<span id="cb114-25"><a href="correspondence-analysis.html#cb114-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">2</span>),</span>
<span id="cb114-26"><a href="correspondence-analysis.html#cb114-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">scores</span>(spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">scaling =</span> <span class="dv">2</span>)),</span>
<span id="cb114-27"><a href="correspondence-analysis.html#cb114-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="/ca_biplot.png" class="align-center" /></p>
<p>These biplots show that a group of sites located in the left part with
similar fish community characterized by numerous species such as GAR,
TAN, PER, ROT, PSO and CAR; in the upper right corner, an other site
cluster characterized by the species LOC, VAI and TRU is identified; the
last site cluster in the lower right corner of the biplot is
characterized by the species BLA, CHA and OMB.</p>
<p><strong>Challenge 4</strong> Run a CA of the “mite” species abundance data. What are
the significant axes of variation? Which groups of sites can you
identify? Which species are related to each group of sites?</p>
<p><strong>Challenge 4 - Solution</strong> &lt;hidden&gt; Your code likely looks something
like the following:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="correspondence-analysis.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CA on mite species</span></span>
<span id="cb115-2"><a href="correspondence-analysis.html#cb115-2" aria-hidden="true" tabindex="-1"></a>mite.spe.ca <span class="ot">&lt;-</span> <span class="fu">cca</span>(mite.spe)</span>
<span id="cb115-3"><a href="correspondence-analysis.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="correspondence-analysis.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the significant axes ?</span></span>
<span id="cb115-5"><a href="correspondence-analysis.html#cb115-5" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> mite.spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb115-6"><a href="correspondence-analysis.html#cb115-6" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb115-7"><a href="correspondence-analysis.html#cb115-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(ev)</span>
<span id="cb115-8"><a href="correspondence-analysis.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb115-9"><a href="correspondence-analysis.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb115-10"><a href="correspondence-analysis.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb115-11"><a href="correspondence-analysis.html#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="correspondence-analysis.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Output summary/results</span></span>
<span id="cb115-13"><a href="correspondence-analysis.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mite.spe.ca, <span class="at">display =</span> <span class="cn">NULL</span>)</span>
<span id="cb115-14"><a href="correspondence-analysis.html#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="correspondence-analysis.html#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the biplot</span></span>
<span id="cb115-16"><a href="correspondence-analysis.html#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb115-17"><a href="correspondence-analysis.html#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mite.spe.ca, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>, <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;PC1 (%)&quot;</span>,</span>
<span id="cb115-18"><a href="correspondence-analysis.html#cb115-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((mite.spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mite.spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb115-19"><a href="correspondence-analysis.html#cb115-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2</span>)), <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;PC2 (%)&quot;</span>, <span class="fu">round</span>((mite.spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mite.spe.ca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb115-20"><a href="correspondence-analysis.html#cb115-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>, <span class="dv">2</span>)))</span>
<span id="cb115-21"><a href="correspondence-analysis.html#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(mite.spe.ca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb115-22"><a href="correspondence-analysis.html#cb115-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">1</span>), <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb115-23"><a href="correspondence-analysis.html#cb115-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb115-24"><a href="correspondence-analysis.html#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(mite.spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb115-25"><a href="correspondence-analysis.html#cb115-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="dv">1</span>), <span class="fu">scores</span>(mite.spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">2</span>),</span>
<span id="cb115-26"><a href="correspondence-analysis.html#cb115-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">scores</span>(mite.spe.ca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>,</span>
<span id="cb115-27"><a href="correspondence-analysis.html#cb115-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p>And your resulting biplot likely looks something like this:</p>
<p><img src="/ca_mite_biplot.png" class="align-center" /></p>
<p>&lt;/hidden&gt;</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="principal-component-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="principal-coordinates-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
