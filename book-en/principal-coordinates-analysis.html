<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Principal Coordinates Analysis | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Principal Coordinates Analysis | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Principal Coordinates Analysis | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="correspondence-analysis.html"/>
<link rel="next" href="nonmetric-multidimensional-scaling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="what-is-ordination.html"><a href="what-is-ordination.html"><i class="fa fa-check"></i><b>3</b> What is ordination?</a></li>
<li class="chapter" data-level="4" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>4</b> Exploring the dataset</a><ul>
<li class="chapter" data-level="4.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#species-data"><i class="fa fa-check"></i><b>4.1</b> Species data</a></li>
<li class="chapter" data-level="4.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#environmental-data"><i class="fa fa-check"></i><b>4.2</b> Environmental data</a></li>
</ul></li>
<li class="part"><span><b>Measures of association</b></span></li>
<li class="chapter" data-level="5" data-path="data-dissimilarity.html"><a href="data-dissimilarity.html"><i class="fa fa-check"></i><b>5</b> Data (dis)similarity</a></li>
<li class="chapter" data-level="6" data-path="quantifying-data-dissimilarity.html"><a href="quantifying-data-dissimilarity.html"><i class="fa fa-check"></i><b>6</b> Quantifying data (dis)similarity</a><ul>
<li class="chapter" data-level="6.1" data-path="quantifying-data-dissimilarity.html"><a href="quantifying-data-dissimilarity.html#transformations-of-community-composition-data"><i class="fa fa-check"></i><b>6.1</b> Transformations of community composition data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>7</b> Clustering</a></li>
<li class="part"><span><b>Unconstrained Ordination</b></span></li>
<li class="chapter" data-level="8" data-path="what-does-unconstrained-mean.html"><a href="what-does-unconstrained-mean.html"><i class="fa fa-check"></i><b>8</b> What does “unconstrained” mean?</a></li>
<li class="chapter" data-level="9" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>9</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="10" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>10</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="11" data-path="principal-coordinates-analysis.html"><a href="principal-coordinates-analysis.html"><i class="fa fa-check"></i><b>11</b> Principal Coordinates Analysis</a></li>
<li class="chapter" data-level="12" data-path="nonmetric-multidimensional-scaling.html"><a href="nonmetric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>12</b> Nonmetric MultiDimensional Scaling</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="13" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>13</b> Summary</a></li>
<li class="chapter" data-level="14" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>14</b> Additional resources</a></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="principal-coordinates-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Principal Coordinates Analysis</h1>
<p>PCA as well as CA impose the distance preserved among objects: the
Euclidean distance (and several others with pre-transformations) for PCA
and the Chi2 distance for CA. If one wishes to ordinate objects on the
basis of another distance measure, more appropriate to the problem at
hand, then PCoA is the method of choice. In PCA we rotated and plotted
our data so that as much variation was explained by a first Principal
Component and we can see how much "species", either actual species or
environmental variables, contribute to each component by looking at the
scores (also called loadings). Another type of unconstrained ordination
is called Principal Coordinate Analysis (PCoA). In PCoA, points are
added to plane space one at a time using Euclidean distance (<em>or
whatever distance (dissimilarity) metric you choose</em>). Basically, one
point is added, then a second so that it's distance is correct from the
first point and then the third point and so on adding as many axes
(dimensions) as necessary along the way. Choosing between PCA and PCoA
can be tricky, but generally PCA is used to summarize multivariate data
into as few dimensions as possible, whereas PCoA can be used to
visualize distances between points. PCoA can be particularly suited for
datasets that have more columns than rows. For example, if hundreds of
species have been observed over a set of quadrats, then a approach based
on a PCoA using Bray-Curtis similarity (see below) may be best suited.</p>
<p>Run a PCoA on the Hellinger transformed species abundances (back to
DoubsSpe):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="principal-coordinates-analysis.html#cb46-1"></a><span class="co">#Using cmdscale()</span></span>
<span id="cb46-2"><a href="principal-coordinates-analysis.html#cb46-2"></a>?cmdscale</span>
<span id="cb46-3"><a href="principal-coordinates-analysis.html#cb46-3"></a><span class="kw">cmdscale</span>(<span class="kw">dist</span>(spe.hel), <span class="dt">k=</span>(<span class="kw">nrow</span>(spe)<span class="op">-</span><span class="dv">1</span>), <span class="dt">eig=</span><span class="ot">TRUE</span>)</span>
<span id="cb46-4"><a href="principal-coordinates-analysis.html#cb46-4"></a></span>
<span id="cb46-5"><a href="principal-coordinates-analysis.html#cb46-5"></a><span class="co">#Using pcoa()</span></span>
<span id="cb46-6"><a href="principal-coordinates-analysis.html#cb46-6"></a>?pcoa</span>
<span id="cb46-7"><a href="principal-coordinates-analysis.html#cb46-7"></a>spe.h.pcoa &lt;-<span class="st"> </span><span class="kw">pcoa</span>(<span class="kw">dist</span>(spe.hel))</span>
<span id="cb46-8"><a href="principal-coordinates-analysis.html#cb46-8"></a></span>
<span id="cb46-9"><a href="principal-coordinates-analysis.html#cb46-9"></a><span class="co"># Extract the results</span></span>
<span id="cb46-10"><a href="principal-coordinates-analysis.html#cb46-10"></a>spe.h.pcoa </span>
<span id="cb46-11"><a href="principal-coordinates-analysis.html#cb46-11"></a></span>
<span id="cb46-12"><a href="principal-coordinates-analysis.html#cb46-12"></a><span class="co">#Construct the biplot</span></span>
<span id="cb46-13"><a href="principal-coordinates-analysis.html#cb46-13"></a><span class="kw">biplot.pcoa</span>(spe .h.pcoa, spe.hel, <span class="dt">dir.axis2=</span><span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>The output looks like this (and here
<a href="https://www.youtube.com/watch?v=lRdX1qhI7Dw">here</a> is a video that
might help with the explanation of eigenvalues in terms of ordination):</p>
<p><img src="/pcoaoutput_1.png" width="800" /></p>
<p><img src="/pcoaoutput_2.png" width="800" /></p>
<p>And the PCoA biplot, like this:</p>
<p><img src="/pcoa_spe.png" width="500" /></p>
<p>You can also run a PCoA using a different distance measure (e.g.
Bray-Curtis). Here is a PCoA run on a Bray-Curtis dissimilarity matrix:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="principal-coordinates-analysis.html#cb47-1"></a>spe.bray.pcoa &lt;-<span class="st"> </span><span class="kw">pcoa</span>(spe.db)  <span class="co">#where spe.db is the species dissimilarity matrix using Bray-Curtis. </span></span>
<span id="cb47-2"><a href="principal-coordinates-analysis.html#cb47-2"></a>spe.bray.pcoa</span>
<span id="cb47-3"><a href="principal-coordinates-analysis.html#cb47-3"></a><span class="kw">biplot.pcoa</span>(spe.bray.pcoa, spe.hel, <span class="dt">dir.axis2 =</span> <span class="dv">-1</span>)</span>
<span id="cb47-4"><a href="principal-coordinates-analysis.html#cb47-4"></a><span class="co"># Note that the distance measure chosen strongly influences</span></span>
<span id="cb47-5"><a href="principal-coordinates-analysis.html#cb47-5"></a><span class="co"># the results.</span></span></code></pre></div>
<p><strong>Challenge 5</strong> Run a PCoA on the Hellinger-transformed <em>mite species</em>
abundance data. What are the significant axes? Which groups of sites can
you identify? Which species are related to each group of sites? How do
the PCoA results compare with the PCA results?</p>
<p><strong>Challenge 5 - Solution</strong> &lt;hidden&gt; Your code likely looks something
like this:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="principal-coordinates-analysis.html#cb48-1"></a>mite.spe.h.pcoa &lt;-<span class="st"> </span><span class="kw">pcoa</span>(<span class="kw">dist</span>(mite.spe.hel))</span>
<span id="cb48-2"><a href="principal-coordinates-analysis.html#cb48-2"></a>mite.spe.h.pcoa</span>
<span id="cb48-3"><a href="principal-coordinates-analysis.html#cb48-3"></a><span class="kw">windows</span>()</span>
<span id="cb48-4"><a href="principal-coordinates-analysis.html#cb48-4"></a><span class="kw">biplot.pcoa</span>(mite.spe.h.pcoa, mite.spe.hel, <span class="dt">dir.axis2 =</span> <span class="dv">-1</span>)</span></code></pre></div>
<p>And your biplot like this:</p>
<p><img src="/pcoa_mite.png" width="500" /></p>
<p>We see that species 16 and 31 are farther away from other species in
terms of distance and therefore their distribution across the sites is
highly dissimilar from the other species of mites (and each other). Site
labels that practically overlap each other are good examples of sites
with low dissimilarity (i.e. high similarity) to each other in terms of
the species that are found at those sites. &lt;/hidden&gt;</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="correspondence-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonmetric-multidimensional-scaling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
