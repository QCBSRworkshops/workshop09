<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Types of distance coefficients | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Types of distance coefficients | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Types of distance coefficients | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="dist.html"/>
<link rel="next" href="transformations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>PREAMBLE</b></span></li>
<li class="chapter" data-level="3" data-path="recap-univariate-analyses.html"><a href="recap-univariate-analyses.html"><i class="fa fa-check"></i><b>3</b> Recap: Univariate analyses</a></li>
<li class="chapter" data-level="4" data-path="intro-multivariate-analyses.html"><a href="intro-multivariate-analyses.html"><i class="fa fa-check"></i><b>4</b> Intro: Multivariate analyses</a></li>
<li class="chapter" data-level="5" data-path="setting-up-our-goals.html"><a href="setting-up-our-goals.html"><i class="fa fa-check"></i><b>5</b> Setting up our goals</a></li>
<li class="chapter" data-level="6" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html"><i class="fa fa-check"></i><b>6</b> Matrix algebra, very briefly</a>
<ul>
<li class="chapter" data-level="6.1" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#data-sets-are-matrices"><i class="fa fa-check"></i><b>6.1</b> Data sets <em>are</em> matrices</a></li>
<li class="chapter" data-level="6.2" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#association-matrices"><i class="fa fa-check"></i><b>6.2</b> Association matrices</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>7</b> Exploring the dataset</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-fish-communities"><i class="fa fa-check"></i><b>7.1</b> Doubs river fish communities</a></li>
<li class="chapter" data-level="7.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-environmental-data"><i class="fa fa-check"></i><b>7.2</b> Doubs river environmental data</a></li>
</ul></li>
<li class="part"><span><b>(Dis)similarity measures</b></span></li>
<li class="chapter" data-level="8" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>8</b> <code>dist()</code></a></li>
<li class="chapter" data-level="9" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html"><i class="fa fa-check"></i><b>9</b> Types of distance coefficients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#metric-distances"><i class="fa fa-check"></i><b>9.1</b> Metric distances</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#euclidean-distances"><i class="fa fa-check"></i><b>9.1.1</b> Euclidean distances</a></li>
<li class="chapter" data-level="9.1.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#challenge-1"><i class="fa fa-check"></i><b>9.1.2</b> Challenge #1</a></li>
<li class="chapter" data-level="9.1.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#chord-distances"><i class="fa fa-check"></i><b>9.1.3</b> Chord distances</a></li>
<li class="chapter" data-level="9.1.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#jaccards-coefficient"><i class="fa fa-check"></i><b>9.1.4</b> Jaccard’s coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#semimetric-distances"><i class="fa fa-check"></i><b>9.2</b> Semimetric distances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#sørensens-coefficient"><i class="fa fa-check"></i><b>9.2.1</b> Sørensen’s coefficient</a></li>
<li class="chapter" data-level="9.2.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#bray-curtis-coefficient"><i class="fa fa-check"></i><b>9.2.2</b> Bray-Curtis’ coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#nonmetric-distances"><i class="fa fa-check"></i><b>9.3</b> Nonmetric distances</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#mahalanobis-distance"><i class="fa fa-check"></i><b>9.3.1</b> Mahalanobis distance</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#representing-distance-matrices"><i class="fa fa-check"></i><b>9.4</b> Representing distance matrices</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>10</b> Transformations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transformations.html"><a href="transformations.html#presence-absence-transformation"><i class="fa fa-check"></i><b>10.1</b> Presence-absence transformation</a></li>
<li class="chapter" data-level="10.2" data-path="transformations.html"><a href="transformations.html#species-profiles-transformation"><i class="fa fa-check"></i><b>10.2</b> Species profiles transformation</a></li>
<li class="chapter" data-level="10.3" data-path="transformations.html"><a href="transformations.html#hellinger-transformation"><i class="fa fa-check"></i><b>10.3</b> Hellinger transformation</a></li>
<li class="chapter" data-level="10.4" data-path="transformations.html"><a href="transformations.html#z-score-standardization"><i class="fa fa-check"></i><b>10.4</b> Z-score standardization</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="transformations.html"><a href="transformations.html#other-association-metrics"><i class="fa fa-check"></i><b>10.4.1</b> Other association metrics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Clustering</b></span></li>
<li class="chapter" data-level="11" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>11</b> Clustering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clustering.html"><a href="clustering.html#single-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.1</b> Single linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.2" data-path="clustering.html"><a href="clustering.html#complete-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.2</b> Complete linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.3" data-path="clustering.html"><a href="clustering.html#unweighted-pair-group-method-with-arithmetic-mean-upgma"><i class="fa fa-check"></i><b>11.3</b> Unweighted Pair Group Method with Arithmetic Mean (UPGMA)</a></li>
<li class="chapter" data-level="11.4" data-path="clustering.html"><a href="clustering.html#weighted-pair-group-method-with-arithmetic-mean-wpgma"><i class="fa fa-check"></i><b>11.4</b> Weighted Pair Group Method with Arithmetic Mean (WPGMA)</a></li>
<li class="chapter" data-level="11.5" data-path="clustering.html"><a href="clustering.html#wards-minimum-variance"><i class="fa fa-check"></i><b>11.5</b> Ward’s minimum variance</a></li>
<li class="chapter" data-level="11.6" data-path="clustering.html"><a href="clustering.html#deciding-on-cut-off-points"><i class="fa fa-check"></i><b>11.6</b> Deciding on cut-off points</a></li>
<li class="chapter" data-level="11.7" data-path="clustering.html"><a href="clustering.html#playing-with-real-data-the-doubs-fish-species-data"><i class="fa fa-check"></i><b>11.7</b> Playing with real data: the Doubs fish species data</a></li>
</ul></li>
<li class="part"><span><b>Unconstrained Ordination</b></span></li>
<li class="chapter" data-level="12" data-path="what-does-unconstrained-mean.html"><a href="what-does-unconstrained-mean.html"><i class="fa fa-check"></i><b>12</b> What does “unconstrained” mean?</a></li>
<li class="chapter" data-level="13" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-not-in-a-nutshell"><i class="fa fa-check"></i><b>13.1</b> Principal component analysis <em>not</em> in a nutshell</a></li>
<li class="chapter" data-level="13.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-using-package-functions"><i class="fa fa-check"></i><b>13.2</b> Principal component analysis using package functions</a></li>
<li class="chapter" data-level="13.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-on-ecological-data"><i class="fa fa-check"></i><b>13.3</b> Principal component analysis on ecological data</a></li>
<li class="chapter" data-level="13.4" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#condensing-data-with-principal-component-analysis"><i class="fa fa-check"></i><b>13.4</b> Condensing data with principal component analysis</a></li>
<li class="chapter" data-level="13.5" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#scaling"><i class="fa fa-check"></i><b>13.5</b> Scaling</a></li>
<li class="chapter" data-level="13.6" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#challenge-2"><i class="fa fa-check"></i><b>13.6</b> Challenge #2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>14</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="15" data-path="principal-coordinates-analysis.html"><a href="principal-coordinates-analysis.html"><i class="fa fa-check"></i><b>15</b> Principal Coordinates Analysis</a></li>
<li class="chapter" data-level="16" data-path="nonmetric-multidimensional-scaling.html"><a href="nonmetric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>16</b> Nonmetric MultiDimensional Scaling</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="17" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>17</b> Summary</a></li>
<li class="chapter" data-level="18" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18</b> Additional resources</a></li>
<li class="chapter" data-level="19" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>19</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="types-of-distance-coefficients" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Types of distance coefficients<a href="types-of-distance-coefficients.html#types-of-distance-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>There are three groups of distance coefficients: <em>metrics</em>, <em>semimetrics</em>, and <em>nonmetrics</em> .</p>
<div id="metric-distances" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Metric distances<a href="types-of-distance-coefficients.html#metric-distances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first group consists of <em>metrics</em>, and its coefficients satisfy the following properties:</p>
<ol style="list-style-type: decimal">
<li><p>minimum 0: if species <span class="math inline">\(a\)</span> is equal to species <span class="math inline">\(b\)</span>, then <span class="math inline">\(D(a,b)=0\)</span>; ✅</p></li>
<li><p>positiveness: if <span class="math inline">\(a \neq b\)</span>, then <span class="math inline">\(D(a,b) &gt; 0\)</span>; ✅</p></li>
<li><p>symmetry: <span class="math inline">\(D(a,b) = D(b,a)\)</span>; ✅</p></li>
<li><p>triangle inequality: <span class="math inline">\(D(a,b) + D(b,c) \geq D(a,c)\)</span>. The sum of two sides of a triangle drawn in the Euclidean space is equal or greater than the third side. ✅</p></li>
</ol>
<p>We can spot all these properties below:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="types-of-distance-coefficients.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(<span class="fu">dist</span>(spe))[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##           1         2         3        4         5        6
## 1  0.000000  5.385165  7.416198 7.874008 10.816654 7.348469
## 2  5.385165  0.000000  2.449490 4.123106 10.677078 4.582576
## 3  7.416198  2.449490  0.000000 3.000000 10.862780 4.123106
## 4  7.874008  4.123106  3.000000 0.000000  9.219544 2.828427
## 5 10.816654 10.677078 10.862780 9.219544  0.000000 8.185353
## 6  7.348469  4.582576  4.123106 2.828427  8.185353 0.000000</code></pre>
<div id="euclidean-distances" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Euclidean distances<a href="types-of-distance-coefficients.html#euclidean-distances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The most common metric distance measure is the <em>Euclidean distance</em>.</p>
<p>Euclidean distance is a measure of the distance between two points in Euclidean space. In two dimensions, the Euclidean distance between two points (x1, y1) and (x2, y2) can be calculated using the Pythagorean theorem:</p>
<p><span class="math display">\[D_{1} (x_1,x_2) = \sqrt{\sum_{j=1}^p(y_{1j} - y_{2j})^2}\]</span></p>
<p><img src="book-en_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Euclidean distance is a commonly used measure in multivariate analyses because it provides a straightforward and intuitive way to measure the distance or similarity between observations in a multidimensional space.</p>
<p>Using <code>stats::dist()</code>, we can compute it with:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="types-of-distance-coefficients.html#cb26-1" aria-hidden="true" tabindex="-1"></a>spe.D.Euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="at">x =</span> spe, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span></code></pre></div>
<p>And, we can test whether a distance is Euclidean using:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="types-of-distance-coefficients.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.euclid</span>(spe.D.Euclid)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="challenge-1" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Challenge #1<a href="types-of-distance-coefficients.html#challenge-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Your turn!</strong> Using the <code>dist()</code> function, compute the Euclidean distance matrix <span class="math inline">\(D_{hmm}\)</span> for the species abundances by site matrix <span class="math inline">\(Y_{hmm}\)</span> below:</p>
<table>
<thead>
<tr class="header">
<th align="center">Sites</th>
<th align="center"><span class="math inline">\(y_1\)</span></th>
<th align="center"><span class="math inline">\(y_2\)</span></th>
<th align="center"><span class="math inline">\(y_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(s_1\)</span></td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(s_2\)</span></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(s_3\)</span></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="types-of-distance-coefficients.html#cb29-1" aria-hidden="true" tabindex="-1"></a>Y.hmm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y1 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y2 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">y3 =</span> <span class="fu">c</span>(<span class="dv">8</span>,</span>
<span id="cb29-2"><a href="types-of-distance-coefficients.html#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>After this, look into the numbers, think critically about them!</p>
<p><strong>Solution:</strong></p>
<p>You should have something similar to this:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="types-of-distance-coefficients.html#cb30-1" aria-hidden="true" tabindex="-1"></a>Y.hmm.DistEu <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="at">x =</span> Y.hmm, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb30-2"><a href="types-of-distance-coefficients.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="types-of-distance-coefficients.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(Y.hmm.DistEu)</span></code></pre></div>
<pre><code>##          1        2        3
## 1 0.000000 7.615773 9.000000
## 2 7.615773 0.000000 1.732051
## 3 9.000000 1.732051 0.000000</code></pre>
<p><em>Now, look into the composition and the distances between sites</em> <span class="math inline">\(s_2\)</span> and <span class="math inline">\(s_3\)</span> and between <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>. What is going on?</p>
<p>The Euclidean distance between sites <span class="math inline">\(s_2\)</span> and <span class="math inline">\(s_3\)</span>, which have no species in common, is smaller than the distance between <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>, which share species <span class="math inline">\(y_2\)</span> and <span class="math inline">\(y_3\)</span> (!).</p>
<p>From an ecological perspective, <em>this is a problematic</em> assessment of the relationship among sites.</p>
<p>This issue is known as the <strong>double-zero problem</strong>, <em>i.e.</em> double zeroes are treated in the same way as double presences, so that the double zeros shrink the distance between two sites.</p>
<p>Euclidean distances ( <span class="math inline">\(D_1\)</span> ) should thus <em>not</em> be used to compare sites based on species abundances.</p>
</div>
<div id="chord-distances" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Chord distances<a href="types-of-distance-coefficients.html#chord-distances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Orlóci (1967) proposed the <em>Chord distance</em> to analyse community composition.</p>
<p>Chord distance, also known as angular distance or great-circle distance, is a measure of the distance between two points on a sphere, such as the Earth.</p>
<p>It consists of:</p>
<p>1. Normalizing the data, <em>i.e.</em> scaling site vectors to length 1 by dividing species abundances in a given sample by the square-rooted sum of square abundances in all samples as</p>
<p><span class="math display">\[y&#39;_{Uj}=y_{Uj}/\sum^s_{j=1}{y^2_{Uj}}\]</span></p>
<p>2. Calculating the Euclidean distances on this normalized data:</p>
<p><span class="math display">\[D_{3} (x_1,x_2) = \sqrt{\sum_{j=1}^p(y&#39;_{1j} - y&#39;_{2j})^2}\]</span></p>
<p>We can use <code>vegan::vegdist()</code> for this one:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="types-of-distance-coefficients.html#cb32-1" aria-hidden="true" tabindex="-1"></a>spe.D.Ch <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(spe, <span class="at">method =</span> <span class="st">&quot;chord&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in vegdist(spe, method = &quot;chord&quot;): you have empty rows: their dissimilarities may be
##                  meaningless in method &quot;chord&quot;</code></pre>
<pre><code>## Warning in vegdist(spe, method = &quot;chord&quot;): missing values in results</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="types-of-distance-coefficients.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(spe.D.Ch)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##           1         2         3
## 1 0.0000000 0.7653669 0.9235374
## 2 0.7653669 0.0000000 0.2309609
## 3 0.9235374 0.2309609 0.0000000</code></pre>
<p>When two sites share the same species in the same proportions of the number of individuals the value of <span class="math inline">\(D_3\)</span> is <span class="math inline">\(0\)</span>, and when no species are shared, its value is <span class="math inline">\(\sqrt{2}\)</span>.</p>
<p><em>What happens if we compute Chord distances in the same site-by-species matrix</em> <span class="math inline">\(Y_{hmm}\)</span>?</p>
<p>Let us try the Chord distances in the same matrix we used for Challenge #1:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="types-of-distance-coefficients.html#cb37-1" aria-hidden="true" tabindex="-1"></a>Y.hmm.DistCh <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(Y.hmm, <span class="at">method =</span> <span class="st">&quot;chord&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="types-of-distance-coefficients.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(Y.hmm.DistCh)</span></code></pre></div>
<pre><code>##           1         2        3
## 1 0.0000000 0.3203645 1.414214
## 2 0.3203645 0.0000000 1.414214
## 3 1.4142136 1.4142136 0.000000</code></pre>
<p>Now, let us compare with what we obtained when we used Euclidean distances:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="types-of-distance-coefficients.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(Y.hmm.DistEu)</span></code></pre></div>
<pre><code>##          1        2        3
## 1 0.000000 7.615773 9.000000
## 2 7.615773 0.000000 1.732051
## 3 9.000000 1.732051 0.000000</code></pre>
<p>See again how our matrix looks:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="types-of-distance-coefficients.html#cb42-1" aria-hidden="true" tabindex="-1"></a>Y.hmm</span></code></pre></div>
<pre><code>##   y1 y2 y3
## 1  0  4  8
## 2  0  1  1
## 3  1  0  0</code></pre>
<p>So, adding any number of double zeroes to a pair of sites does <em>not</em> change the value of <span class="math inline">\(D_3\)</span>. Hence, <em>Chord distances</em> can be used to compare sites described by species abundances!</p>
</div>
<div id="jaccards-coefficient" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Jaccard’s coefficient<a href="types-of-distance-coefficients.html#jaccards-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another popular association coefficient is the <em>Jaccard similarity coefficient</em> (1900).</p>
<p>The Jaccard similarity coefficient was originally proposed by the French mathematician Paul Jaccard in 1901, in the context of ecology. Jaccard was interested in comparing the species composition of different plant communities, and proposed the Jaccard index as a measure of similarity between two communities based on their species richness.</p>
<p>Jaccard’s similarity coefficient is only appropriate for <strong>binary data</strong>, and its distance coefficient is defined with the size of the intersection divided by the size of the union of the sample sets.</p>
<p><span class="math display">\[D_{7}(x_1,x_2) = 1 - \frac{\vert x_1 \cap x_2 \vert}{\vert x_1 \cup x_2 \vert} = 1 - \frac{\vert x_1 \cap x_2 \vert}{\vert x_1 \vert + \vert x_2 \vert - \vert x_1 \cap x_2 \vert} = 1-\frac{a}{a+b+c}\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(a\)</span> is the number of species shared between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> that are coded <span class="math inline">\(1\)</span>;</li>
<li><span class="math inline">\(b\)</span> is the number of occurrences where <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are known to be different;</li>
<li><span class="math inline">\(c\)</span> is the number of common absences between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, <em>i.e.</em> both <span class="math inline">\(0\)</span>.</li>
</ul>
<p>For example, for sites <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x_1,x_2\)</span></th>
<th align="center"><span class="math inline">\(y_1\)</span></th>
<th align="center"><span class="math inline">\(y_2\)</span></th>
<th align="center"><span class="math inline">\(y_3\)</span></th>
<th align="center"><span class="math inline">\(y_4\)</span></th>
<th align="center"><span class="math inline">\(y_5\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(x_1\)</span></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(x_2\)</span></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>So, we can calculate <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span>: - <span class="math inline">\(a\)</span> = 1 + 1 = 2</p>
<ul>
<li><p><span class="math inline">\(b\)</span> = 1 + 1 = 2</p></li>
<li><p><span class="math inline">\(c\)</span> = 1</p></li>
</ul>
<p>And, then our distance coefficient:</p>
<p><span class="math display">\[D_{7}(x_1,x_2) = 1-\frac{2}{2+2+1}= 0.6\]</span></p>
<p>In <code>R</code>, you can use use the <code>vegan::vegdist()</code> function to calculate the Jaccard’s coefficient:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="types-of-distance-coefficients.html#cb44-1" aria-hidden="true" tabindex="-1"></a>spe.D.Jac <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(spe, <span class="at">method =</span> <span class="st">&quot;jaccard&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in vegdist(spe, method = &quot;jaccard&quot;, binary = TRUE): you have empty rows: their dissimilarities may be
##                  meaningless in method &quot;jaccard&quot;</code></pre>
</div>
</div>
<div id="semimetric-distances" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Semimetric distances<a href="types-of-distance-coefficients.html#semimetric-distances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The second group consists of <em>semimetrics</em>, and they violate the <em>triangle inequality</em> property:</p>
<ol style="list-style-type: decimal">
<li><p>minimum 0: if species <span class="math inline">\(a\)</span> is equal to species <span class="math inline">\(b\)</span>, then <span class="math inline">\(D(a,b)=0\)</span>; ✅</p></li>
<li><p>positiveness: if <span class="math inline">\(a \neq b\)</span>, then <span class="math inline">\(D(a,b) &gt; 0\)</span>; ✅</p></li>
<li><p>symmetry: <span class="math inline">\(D(a,b) = D(b,a)\)</span>; ✅</p></li>
<li><p><del>triangle inequality</del>: <span class="math inline">\({D(a,b) + D(b,c) \geq or &lt; D(a,c)}\)</span>. The sum of two sides of a triangle drawn in the Euclidean space is <em>not</em> equal or greater than the third side. ❌</p></li>
</ol>
<div id="sørensens-coefficient" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Sørensen’s coefficient<a href="types-of-distance-coefficients.html#sørensens-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All parameters in <em>Jaccard’s similarity coefficient</em> have equal weights.</p>
<p><span class="math display">\[D_{7}(x_1,x_2)=1-\frac{a}{a+b+c}\]</span></p>
<p>However, you may want to consider that a presence of a species is more informative than its absence.</p>
<p>The distance corresponding to <em>Sørensen’s similarity coefficient</em> (1948) gives weight to double presences:</p>
<p><span class="math display">\[D_{13}(x_1,x_2)=1-\frac{2a}{2a+b+c}=\frac{b+c}{2a+b+c}\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(a\)</span> is the number of species shared between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> that are coded <span class="math inline">\(1\)</span>;</li>
<li><span class="math inline">\(b\)</span> is the number of occurrences where <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are known to be different;</li>
<li><span class="math inline">\(c\)</span> is the number of common absences between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, <em>i.e.</em> both <span class="math inline">\(0\)</span>.</li>
</ul>
<p>In <code>R</code>, you can also use the <code>vegan::vegdist()</code> function to calculate the Sørensen’s coefficient:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="types-of-distance-coefficients.html#cb46-1" aria-hidden="true" tabindex="-1"></a>spe.D.Sor <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(spe, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in vegdist(spe, method = &quot;bray&quot;, binary = TRUE): you have empty rows: their dissimilarities may be
##                  meaningless in method &quot;bray&quot;</code></pre>
<blockquote>
<p>Because both Jaccard’s and Sørensen’s are only appropriate for presence-absence data, you must binary-transform abundance data using <code>binary = TRUE</code> in <code>vegdist()</code>.</p>
</blockquote>
</div>
<div id="bray-curtis-coefficient" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Bray-Curtis’ coefficient<a href="types-of-distance-coefficients.html#bray-curtis-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>Bray-Curtis dissimilarity coefficient</em> is a modified version of the Sørensen’s index and allows for species abundances:</p>
<p><span class="math display">\[D_{14}(x_1,x_2)=\frac{\sum{\vert y_{1j}-y_{2j}\vert}}{\sum{( y_{1j}+y_{2j})}}=\]</span></p>
<p><span class="math display">\[D_{14}(x_1,x_2)=1 - \frac{2W}{A+B}\]</span></p>
<p>where,</p>
<ul>
<li><p><span class="math inline">\(W\)</span> is the sum of the lowest abundances in each species found between sites <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>;</p></li>
<li><p><span class="math inline">\(A\)</span> is the sum of all abundances in <span class="math inline">\(x_1\)</span>; and,</p></li>
<li><p><span class="math inline">\(B\)</span> is the sum of all abundances in <span class="math inline">\(x_2\)</span>.</p></li>
</ul>
<p>For example, for sites <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x_1,x_2\)</span></th>
<th align="center"><span class="math inline">\(y_1\)</span></th>
<th align="center"><span class="math inline">\(y_2\)</span></th>
<th align="center"><span class="math inline">\(y_3\)</span></th>
<th align="center"><span class="math inline">\(y_4\)</span></th>
<th align="center"><span class="math inline">\(y_5\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(x_1\)</span></td>
<td align="center"><em>2</em></td>
<td align="center"><em>1</em></td>
<td align="center"><em>0</em></td>
<td align="center">5</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(x_2\)</span></td>
<td align="center">5</td>
<td align="center"><em>1</em></td>
<td align="center">3</td>
<td align="center"><em>1</em></td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>So:</p>
<ul>
<li><p><span class="math inline">\(W = 2 + 1 + 0 + 1 + 1 = 5\)</span></p></li>
<li><p><span class="math inline">\(A = 2 + 1 + 0 + 5 + 0 = 8\)</span></p></li>
<li><p><span class="math inline">\(B = 5 + 1 + 3 + 1 + 2 = 12\)</span></p></li>
</ul>
<p><span class="math display">\[D_{14}(x_1,x_2) = 1-\frac{2 \times 5}{8+12} = 0.5\]</span></p>
<p>To calculate the <em>Bray-Curtis dissimilarity coefficient</em>, which can account for abundances, you need to set <code>binary = FALSE</code>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="types-of-distance-coefficients.html#cb48-1" aria-hidden="true" tabindex="-1"></a>spe.db.pa <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(spe, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in vegdist(spe, method = &quot;bray&quot;, binary = FALSE): you have empty rows: their dissimilarities may be
##                  meaningless in method &quot;bray&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="types-of-distance-coefficients.html#cb50-1" aria-hidden="true" tabindex="-1"></a>spe.db <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(spe.db.pa)</span></code></pre></div>
</div>
</div>
<div id="nonmetric-distances" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Nonmetric distances<a href="types-of-distance-coefficients.html#nonmetric-distances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non-metric distances do not satisfy the metric properties of symmetry, triangle inequality, and identity of indiscernibles:</p>
<ol style="list-style-type: decimal">
<li><p>minimum 0: if species <span class="math inline">\(a\)</span> is equal to species <span class="math inline">\(b\)</span>, then <span class="math inline">\(D(a,b)=0\)</span>; ✅</p></li>
<li><p><del>positiveness:</del> if <span class="math inline">\(a \neq b\)</span>, then <span class="math inline">\(D(a,b) &gt; or &lt; 0\)</span>; ❌</p></li>
<li><p>symmetry: <span class="math inline">\(D(a,b) = D(b,a)\)</span>; ✅</p></li>
<li><p><del>triangle inequality</del>: <span class="math inline">\({D(a,b) + D(b,c) \geq or &lt; D(a,c)}\)</span>. The sum of two sides of a triangle drawn in the Euclidean space is <em>not</em> equal or greater than the third side. ❌</p></li>
</ol>
<div id="mahalanobis-distance" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Mahalanobis distance<a href="types-of-distance-coefficients.html#mahalanobis-distance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Mahalanobis distance between a point <span class="math inline">\(x\)</span> and a group of points with mean <span class="math inline">\(\mu\)</span> and covariance <span class="math inline">\(\Sigma\)</span> is defined as:</p>
<p><span class="math display">\[
D_{M}(x, \mu)=\sqrt{(x-\mu)^{T} \Sigma^{-1}(x-\mu)}
\]</span></p>
<p>where <span class="math inline">\(T\)</span> denotes the transpose, and <span class="math inline">\(\Sigma^{-1}\)</span> is the inverse (or generalized inverse) of the covariance matrix <span class="math inline">\(\Sigma\)</span>.</p>
<p>The Mahalanobis distance is a measure of the distance between a point and a group of points, taking into account the covariance structure of the data.</p>
<p>The inverse of the covariance matrix may not exist in some cases, such as when the variables are linearly dependent or when there are more variables than observations. In these cases, we can use the generalized inverse of the covariance matrix instead of the inverse to calculate the Mahalanobis distance.</p>
<p>This generalized inverse can be calculated using various methods, such as the Moore-Penrose pseudoinverse or the singular value decomposition.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="types-of-distance-coefficients.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a matrix</span></span>
<span id="cb51-2"><a href="types-of-distance-coefficients.html#cb51-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb51-3"><a href="types-of-distance-coefficients.html#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="types-of-distance-coefficients.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the covariance matrix and its generalized inverse</span></span>
<span id="cb51-5"><a href="types-of-distance-coefficients.html#cb51-5" aria-hidden="true" tabindex="-1"></a>cov_mat <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb51-6"><a href="types-of-distance-coefficients.html#cb51-6" aria-hidden="true" tabindex="-1"></a>cov_inv <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">ginv</span>(cov_mat)</span>
<span id="cb51-7"><a href="types-of-distance-coefficients.html#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="types-of-distance-coefficients.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Mahalanobis distance using the generalized</span></span>
<span id="cb51-9"><a href="types-of-distance-coefficients.html#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse</span></span>
<span id="cb51-10"><a href="types-of-distance-coefficients.html#cb51-10" aria-hidden="true" tabindex="-1"></a>mah_dist <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(x, <span class="fu">colMeans</span>(x), cov_inv)</span>
<span id="cb51-11"><a href="types-of-distance-coefficients.html#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="types-of-distance-coefficients.html#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the Mahalanobis distance</span></span>
<span id="cb51-13"><a href="types-of-distance-coefficients.html#cb51-13" aria-hidden="true" tabindex="-1"></a>mah_dist</span></code></pre></div>
<pre><code>##   [1]  2.77759442  1.36979910  1.39037318  8.23085219  2.56359561  2.44879758
##   [7]  2.57598529  1.27877068  7.18147323  4.60092981  1.51016865  1.38571378
##  [13]  4.19999073  5.91708452  2.98098933  0.04334035  0.20363713  3.11226014
##  [19]  2.68572499  0.57382713  1.46243718  0.64098883  1.03987831  5.06614808
##  [25]  3.97412553  1.09851740  1.53680255  3.69098701  3.65219203  3.43358298
##  [31]  1.16893734  5.88041373  6.46092577  0.81153921  0.85245696  2.68380302
##  [37]  2.00925851  1.28104545  2.73183681  0.76313551 17.79092348  0.55972905
##  [43]  0.12010564  9.60075976  3.85766290  0.27795764  1.54283910  3.87224569
##  [49]  0.41529634  3.60679774  2.68771637  0.33507998  1.66709799  2.87601388
##  [55]  2.69167639  9.81973571  2.10230386  0.01373487  2.81971004  7.64725661
##  [61]  1.11557044  0.59158952  1.07966345  1.26005437  0.97218383  3.15744529
##  [67]  4.56171356  2.70019824  6.33479411  4.24711483  1.35315649  5.40114200
##  [73]  6.16439001  0.71391613  3.79505963  1.43023580  3.57451487  3.70545082
##  [79]  0.01269480  1.94989581  2.86424911  4.10996728  1.71206256  4.91631748
##  [85]  0.90739042  6.02282957  2.15244926  3.70590021  1.30187133  4.32876258
##  [91]  6.69820659  3.90052998  0.81805775  2.11232684  0.99633476  4.04884052
##  [97]  2.16980086  4.87238376  0.76564709  2.45455038</code></pre>
</div>
</div>
<div id="representing-distance-matrices" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Representing distance matrices<a href="types-of-distance-coefficients.html#representing-distance-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can create graphical depictions of association matrices using the <code>coldiss()</code> function:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="types-of-distance-coefficients.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coldiss() function Color plots of a dissimilarity matrix,</span></span>
<span id="cb53-2"><a href="types-of-distance-coefficients.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># without and with ordering License: GPL-2 Author: Francois</span></span>
<span id="cb53-3"><a href="types-of-distance-coefficients.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gillet, 23 August 2012</span></span>
<span id="cb53-4"><a href="types-of-distance-coefficients.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="types-of-distance-coefficients.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;coldiss&quot;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(D, <span class="at">nc =</span> <span class="dv">4</span>, <span class="at">byrank =</span> <span class="cn">TRUE</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb53-6"><a href="types-of-distance-coefficients.html#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">require</span>(gclus)</span>
<span id="cb53-7"><a href="types-of-distance-coefficients.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="types-of-distance-coefficients.html#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">max</span>(D) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb53-9"><a href="types-of-distance-coefficients.html#cb53-9" aria-hidden="true" tabindex="-1"></a>        D <span class="ot">&lt;-</span> D<span class="sc">/</span><span class="fu">max</span>(D)</span>
<span id="cb53-10"><a href="types-of-distance-coefficients.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="types-of-distance-coefficients.html#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (byrank) {</span>
<span id="cb53-12"><a href="types-of-distance-coefficients.html#cb53-12" aria-hidden="true" tabindex="-1"></a>        spe.color <span class="ot">&lt;-</span> <span class="fu">dmat.color</span>(<span class="dv">1</span> <span class="sc">-</span> D, <span class="fu">cm.colors</span>(nc))</span>
<span id="cb53-13"><a href="types-of-distance-coefficients.html#cb53-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb53-14"><a href="types-of-distance-coefficients.html#cb53-14" aria-hidden="true" tabindex="-1"></a>        spe.color <span class="ot">&lt;-</span> <span class="fu">dmat.color</span>(<span class="dv">1</span> <span class="sc">-</span> D, <span class="at">byrank =</span> <span class="cn">FALSE</span>, <span class="fu">cm.colors</span>(nc))</span>
<span id="cb53-15"><a href="types-of-distance-coefficients.html#cb53-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-16"><a href="types-of-distance-coefficients.html#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="types-of-distance-coefficients.html#cb53-17" aria-hidden="true" tabindex="-1"></a>    spe.o <span class="ot">&lt;-</span> <span class="fu">order.single</span>(<span class="dv">1</span> <span class="sc">-</span> D)</span>
<span id="cb53-18"><a href="types-of-distance-coefficients.html#cb53-18" aria-hidden="true" tabindex="-1"></a>    speo.color <span class="ot">&lt;-</span> spe.color[spe.o, spe.o]</span>
<span id="cb53-19"><a href="types-of-distance-coefficients.html#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="types-of-distance-coefficients.html#cb53-20" aria-hidden="true" tabindex="-1"></a>    op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb53-21"><a href="types-of-distance-coefficients.html#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="types-of-distance-coefficients.html#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (diag) {</span>
<span id="cb53-23"><a href="types-of-distance-coefficients.html#cb53-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotcolors</span>(spe.color, <span class="at">rlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels,</span>
<span id="cb53-24"><a href="types-of-distance-coefficients.html#cb53-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Dissimilarity Matrix&quot;</span>, <span class="at">dlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels)</span>
<span id="cb53-25"><a href="types-of-distance-coefficients.html#cb53-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotcolors</span>(speo.color, <span class="at">rlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels[spe.o],</span>
<span id="cb53-26"><a href="types-of-distance-coefficients.html#cb53-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Ordered Dissimilarity Matrix&quot;</span>, <span class="at">dlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels[spe.o])</span>
<span id="cb53-27"><a href="types-of-distance-coefficients.html#cb53-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb53-28"><a href="types-of-distance-coefficients.html#cb53-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotcolors</span>(spe.color, <span class="at">rlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels,</span>
<span id="cb53-29"><a href="types-of-distance-coefficients.html#cb53-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Dissimilarity Matrix&quot;</span>)</span>
<span id="cb53-30"><a href="types-of-distance-coefficients.html#cb53-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotcolors</span>(speo.color, <span class="at">rlabels =</span> <span class="fu">attributes</span>(D)<span class="sc">$</span>Labels[spe.o],</span>
<span id="cb53-31"><a href="types-of-distance-coefficients.html#cb53-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Ordered Dissimilarity Matrix&quot;</span>)</span>
<span id="cb53-32"><a href="types-of-distance-coefficients.html#cb53-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-33"><a href="types-of-distance-coefficients.html#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="types-of-distance-coefficients.html#cb53-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(op)</span>
<span id="cb53-35"><a href="types-of-distance-coefficients.html#cb53-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-36"><a href="types-of-distance-coefficients.html#cb53-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-37"><a href="types-of-distance-coefficients.html#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage: coldiss(D = dissimilarity.matrix, nc = 4, byrank =</span></span>
<span id="cb53-38"><a href="types-of-distance-coefficients.html#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE, diag = FALSE) If D is not a dissimilarity matrix</span></span>
<span id="cb53-39"><a href="types-of-distance-coefficients.html#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (max(D) &gt; 1), then D is divided by max(D) nc</span></span>
<span id="cb53-40"><a href="types-of-distance-coefficients.html#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="co"># \t\t\t\t\t\t\tnumber of colours (classes) byrank=</span></span>
<span id="cb53-41"><a href="types-of-distance-coefficients.html#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE\t\tequal-sized classes byrank= FALSE\t\tequal-length</span></span>
<span id="cb53-42"><a href="types-of-distance-coefficients.html#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals diag = TRUE\t\t\tprint object labels also on</span></span>
<span id="cb53-43"><a href="types-of-distance-coefficients.html#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="co"># the diagonal</span></span>
<span id="cb53-44"><a href="types-of-distance-coefficients.html#cb53-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-45"><a href="types-of-distance-coefficients.html#cb53-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: coldiss(spe.dj, nc=9, byrank=F, diag=T)</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="types-of-distance-coefficients.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coldiss</span>(spe.D.Jac)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-35-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>You can also use <code>ggplot2::ggplot()</code> to represent your matrix using <code>geom_tile()</code>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="types-of-distance-coefficients.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the order of the rows and columns</span></span>
<span id="cb55-2"><a href="types-of-distance-coefficients.html#cb55-2" aria-hidden="true" tabindex="-1"></a>order_spe.D.Jac <span class="ot">&lt;-</span> <span class="fu">hclust</span>(spe.D.Jac, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)<span class="sc">$</span>order</span>
<span id="cb55-3"><a href="types-of-distance-coefficients.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="types-of-distance-coefficients.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder the matrix to produce an figure ordered by</span></span>
<span id="cb55-5"><a href="types-of-distance-coefficients.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># similarities</span></span>
<span id="cb55-6"><a href="types-of-distance-coefficients.html#cb55-6" aria-hidden="true" tabindex="-1"></a>order_spe.D.Jac_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(spe.D.Jac)[order_spe.D.Jac,</span>
<span id="cb55-7"><a href="types-of-distance-coefficients.html#cb55-7" aria-hidden="true" tabindex="-1"></a>    order_spe.D.Jac]</span>
<span id="cb55-8"><a href="types-of-distance-coefficients.html#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="types-of-distance-coefficients.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># converts to data frame</span></span>
<span id="cb55-10"><a href="types-of-distance-coefficients.html#cb55-10" aria-hidden="true" tabindex="-1"></a>molten_spe.D.Jac <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="fu">as.matrix</span>(order_spe.D.Jac_matrix))</span>
<span id="cb55-11"><a href="types-of-distance-coefficients.html#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="types-of-distance-coefficients.html#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create ggplot object</span></span>
<span id="cb55-13"><a href="types-of-distance-coefficients.html#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> molten_spe.D.Jac, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb55-14"><a href="types-of-distance-coefficients.html#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-15"><a href="types-of-distance-coefficients.html#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-36-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="dist.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transformations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
