<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="what-does-unconstrained-mean.html"/>
<link rel="next" href="correspondence-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>PREAMBLE</b></span></li>
<li class="chapter" data-level="3" data-path="recap-univariate-analyses.html"><a href="recap-univariate-analyses.html"><i class="fa fa-check"></i><b>3</b> Recap: Univariate analyses</a></li>
<li class="chapter" data-level="4" data-path="intro-multivariate-analyses.html"><a href="intro-multivariate-analyses.html"><i class="fa fa-check"></i><b>4</b> Intro: Multivariate analyses</a></li>
<li class="chapter" data-level="5" data-path="setting-up-our-goals.html"><a href="setting-up-our-goals.html"><i class="fa fa-check"></i><b>5</b> Setting up our goals</a></li>
<li class="chapter" data-level="6" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html"><i class="fa fa-check"></i><b>6</b> Matrix algebra, very briefly</a>
<ul>
<li class="chapter" data-level="6.1" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#data-sets-are-matrices"><i class="fa fa-check"></i><b>6.1</b> Data sets <em>are</em> matrices</a></li>
<li class="chapter" data-level="6.2" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#association-matrices"><i class="fa fa-check"></i><b>6.2</b> Association matrices</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>7</b> Exploring the dataset</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-fish-communities"><i class="fa fa-check"></i><b>7.1</b> Doubs river fish communities</a></li>
<li class="chapter" data-level="7.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-environmental-data"><i class="fa fa-check"></i><b>7.2</b> Doubs river environmental data</a></li>
</ul></li>
<li class="part"><span><b>(Dis)similarity measures</b></span></li>
<li class="chapter" data-level="8" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>8</b> <code>dist()</code></a></li>
<li class="chapter" data-level="9" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html"><i class="fa fa-check"></i><b>9</b> Types of distance coefficients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#metric-distances"><i class="fa fa-check"></i><b>9.1</b> Metric distances</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#euclidean-distances"><i class="fa fa-check"></i><b>9.1.1</b> Euclidean distances</a></li>
<li class="chapter" data-level="9.1.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#challenge-1"><i class="fa fa-check"></i><b>9.1.2</b> Challenge #1</a></li>
<li class="chapter" data-level="9.1.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#chord-distances"><i class="fa fa-check"></i><b>9.1.3</b> Chord distances</a></li>
<li class="chapter" data-level="9.1.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#jaccards-coefficient"><i class="fa fa-check"></i><b>9.1.4</b> Jaccard’s coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#semimetric-distances"><i class="fa fa-check"></i><b>9.2</b> Semimetric distances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#sørensens-coefficient"><i class="fa fa-check"></i><b>9.2.1</b> Sørensen’s coefficient</a></li>
<li class="chapter" data-level="9.2.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#bray-curtis-coefficient"><i class="fa fa-check"></i><b>9.2.2</b> Bray-Curtis’ coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#nonmetric-distances"><i class="fa fa-check"></i><b>9.3</b> Nonmetric distances</a></li>
<li class="chapter" data-level="9.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#representation"><i class="fa fa-check"></i><b>9.4</b> Representation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>10</b> Transformations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transformations.html"><a href="transformations.html#presence-absence-transformation"><i class="fa fa-check"></i><b>10.1</b> Presence-absence transformation</a></li>
<li class="chapter" data-level="10.2" data-path="transformations.html"><a href="transformations.html#species-profiles-transformation"><i class="fa fa-check"></i><b>10.2</b> Species profiles transformation</a></li>
<li class="chapter" data-level="10.3" data-path="transformations.html"><a href="transformations.html#hellinger-transformation"><i class="fa fa-check"></i><b>10.3</b> Hellinger transformation</a></li>
<li class="chapter" data-level="10.4" data-path="transformations.html"><a href="transformations.html#z-score-standardization"><i class="fa fa-check"></i><b>10.4</b> Z-score standardization</a></li>
</ul></li>
<li class="part"><span><b>Clustering</b></span></li>
<li class="chapter" data-level="11" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>11</b> Clustering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clustering.html"><a href="clustering.html#single-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.1</b> Single linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.2" data-path="clustering.html"><a href="clustering.html#complete-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.2</b> Complete linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.3" data-path="clustering.html"><a href="clustering.html#wards-minimum-variance-clustering"><i class="fa fa-check"></i><b>11.3</b> Ward’s minimum variance clustering</a></li>
</ul></li>
<li class="part"><span><b>Unconstrained Ordination</b></span></li>
<li class="chapter" data-level="12" data-path="what-does-unconstrained-mean.html"><a href="what-does-unconstrained-mean.html"><i class="fa fa-check"></i><b>12</b> What does “unconstrained” mean?</a></li>
<li class="chapter" data-level="13" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="14" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>14</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="15" data-path="principal-coordinates-analysis.html"><a href="principal-coordinates-analysis.html"><i class="fa fa-check"></i><b>15</b> Principal Coordinates Analysis</a></li>
<li class="chapter" data-level="16" data-path="nonmetric-multidimensional-scaling.html"><a href="nonmetric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>16</b> Nonmetric MultiDimensional Scaling</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="17" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>17</b> Summary</a></li>
<li class="chapter" data-level="18" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18</b> Additional resources</a></li>
<li class="chapter" data-level="19" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>19</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="principal-component-analysis" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Principal Component Analysis<a href="principal-component-analysis.html#principal-component-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Principal component analysis (PCA) was originally described by Pearson
(1901) although it is more often attributed to Hotelling (1933) who
proposed it independently. The method and several of its implications
for data analysis are presented in the seminal paper of Rao (1964). PCA
is used to generate a few key variables from a larger set of variables
that still represent as much of the variation in the dataset as
possible. PCA is a powerful technique to analyze quantitative
descriptors (such as species abundances), but cannot be applied to
binary data (such as species absence/presence).</p>
<p>Based on a dataset containing normally distributed variables, the first
axis (or principal-component axis) of a PCA is the line that goes
through the greatest dimension of the concentration ellipsoid describing
the multinormal distribution. Similarly, the following axes go through
the dimensions of the concentration ellipsoid by decreasing length. One
can thus derive a maximum of p principal axes form a data set containing
p variables.</p>
<p>For this, PCA rotates the original system of axes defined by the
variables in a way that the successive new axes are orthogonal to one
another and correspond to the successive dimensions of maximum variance
of the scatter of points. The new variables produced in a PCA are
uncorrelated with each other (axes are orthogonal to each other) and
therefore may be used in other analyses such as multiple regression
(Gotelli and Ellison 2004). The principal components give the positions
of the objects in the new system of coordinates. PCA works on an
association matrix among variables containing the variances and
covariances of the variables. PCA preserves Euclidean distances and
detects linear relationships. As a consequence, raw species abundance
data are subjected to a pre-transformation (i.e. a Hellinger
transformation) before computing a PCA.</p>
<p><em>To do a PCA you need:</em> - A set of variables (with no distinction
between independent or dependent variables, i.e. a set of species OR a
set of environmental variables). - Samples that are measured for the
same set of variables. - Generally a dataset that is longer than it is
wide is preferred.</p>
<p>PCA is most useful with data with more than two variables, but is easier
to describe using a two dimensional example. In this example (derived
from Clarke and Warwick 2001) , we have nine sites with abundance data
for two species:</p>
<table>
<thead>
<tr class="header">
<th align="left">Site</th>
<th align="left">Species 1</th>
<th align="left">Species 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">6</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">5</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">7</td>
<td align="left">6</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="left">11</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">10</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">G</td>
<td align="left">15</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">H</td>
<td align="left">18</td>
<td align="left">14</td>
</tr>
<tr class="odd">
<td align="left">I</td>
<td align="left">14</td>
<td align="left">14</td>
</tr>
</tbody>
</table>
<p>If you plotted these samples in the two dimensions, the plot would look
like this: <img src="/pcaex_1.png" width="500" /></p>
<p>This is a straight forward scatter plot and is an ordination plot, but
you can imagine that it is more difficult to produce and visualize such
a plot if there were more than two species. In that case, you would want
to reduce the number of variables to principal components. If the 2D
plot above was too complex and we wanted to reduce the data into a
single dimension, we would be doing so with a PCA:</p>
<p><img src="/pcaex_2.png" width="500" /></p>
<p>In this case, the first principal component is the line of best fit
through the points (sites) with the sites perpendicular to the line.</p>
<p>A second principal component is then added perpendicular to the first
axis:</p>
<p><img src="/pcaex_3.png" width="500" /></p>
<p>The final plot then is the two PC axes rotated where the axes are now
principal components as opposed to species:</p>
<p><img src="/pcaex_4.png" width="500" /></p>
<p>For PCAs with more than two variables, principal components are added
like this (Clarke and Warwick 2001):</p>
<p>PC1 = axis that maximises the variance of the points that are projected
perpendicularly onto the axis. PC2 = must be perpendicular to PC1, but
the direction is again the one in which variance is maximised when
points are perpendicularly projected. PC3 and so on: perpendicular to
the first two axes. Essentially, when there are more than two
dimensions, PCA produces a new space in which all PCA axes are
orthogonal (e.g. where the correlation among any two axes is null) and
where the PCA axes are ordered according to the percent of the variance
of the original data they explain.</p>
<p>The “spe” data includes 27 fish taxa. To simplify the 27 fish taxa into
a smaller number of fish-related variables or to identify where
different sites or samples are associated with particular fish taxa we
can run a PCA.</p>
<p>Run a PCA on Hellinger-transformed species data:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="principal-component-analysis.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the PCA using the rda() function (NB: rda() is used</span></span>
<span id="cb99-2"><a href="principal-component-analysis.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for both PCA and RDA)</span></span>
<span id="cb99-3"><a href="principal-component-analysis.html#cb99-3" aria-hidden="true" tabindex="-1"></a>spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(spe.hel)</span>
<span id="cb99-4"><a href="principal-component-analysis.html#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="principal-component-analysis.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the results</span></span>
<span id="cb99-6"><a href="principal-component-analysis.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spe.h.pca)  <span class="co">#overall results</span></span></code></pre></div>
<p>The summary looks like this:</p>
<p><img src="/pcaoutput_1v2.png" width="800" /> <img src="/pcaoutput_2.png" width="800" />
<img src="/pcaoutput_3.png" width="800" /></p>
<p><strong>Interpretation of ordination results:</strong></p>
<p>A new word from this output is "eigenvalue". An eigenvalue is the
value of the change in the length of a vector, and for our purposes is
the amount of variation explained by each axis in a PCA. As you can see,
the summary function produces a fair amount of information. From the
summary we can see how much of the variance in the data is explained by
the unconstrained variables (i.e. variables where we have made no effort
to define relationships between the variables). In this case, the total
variance of the sites explained by the species is 0.5. The summary also
tells you what proportion of the total explained variance is explained
by each principal component in the PCA: the first axis of the PCA thus
explains 51.33% of the variation, and the second axis 12.78%. You can
also extract certain parts of the output, try this:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="principal-component-analysis.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spe.h.pca, <span class="at">display =</span> <span class="cn">NULL</span>)  <span class="co"># only eigenvalues and their contribution to the variance</span></span>
<span id="cb100-2"><a href="principal-component-analysis.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(<span class="fu">cov</span>(spe.hel))  <span class="co"># also compute the eigenvalues</span></span></code></pre></div>
<p>Sometimes you may want to extract the scores (i.e. the coordinates
within a PCA biplot) for either the “sites” (the rows in your dataset,
whether they be actual sites or not) or the “species” (the variables in
your data, whether they be actual species or some other variables). This
is useful if you want to then use a principal component as a variable in
another analysis, or to make additional graphics. For example, with the
“spe” dataset, you might want to obtain a single variable that is a
composite of all the fish abundance data and then use that use that
variable in a regression with another variable, or plot across a spatial
gradient. To extract scores from a PCA, use the scores() function:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="principal-component-analysis.html#cb101-1" aria-hidden="true" tabindex="-1"></a>spe.scores <span class="ot">&lt;-</span> <span class="fu">scores</span>(spe.h.pca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb101-2"><a href="principal-component-analysis.html#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>))  <span class="co"># species scores on the first two PCA axes</span></span>
<span id="cb101-3"><a href="principal-component-analysis.html#cb101-3" aria-hidden="true" tabindex="-1"></a>site.scores <span class="ot">&lt;-</span> <span class="fu">scores</span>(spe.h.pca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb101-4"><a href="principal-component-analysis.html#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>))  <span class="co"># sites scores on the first two PCA axes</span></span>
<span id="cb101-5"><a href="principal-component-analysis.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: if you don’t specify the number of principal</span></span>
<span id="cb101-6"><a href="principal-component-analysis.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># components to extract (e.g. choices=c(1,2) or</span></span>
<span id="cb101-7"><a href="principal-component-analysis.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># choices=c(1:2) then all of the scores will be extracted</span></span>
<span id="cb101-8"><a href="principal-component-analysis.html#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for all of the principal components.</span></span></code></pre></div>
<p>The PCA on the “spe” fish data produces as many principal components as
there are fish taxon (columns), which in this case means that 27
principal components are produced. In many cases though, you may have
done a PCA to reduce the number of variables to deal with and produce
composite variables for the fish. In this case, you are likely
interested in knowing how many of these principal components are
actually significant or adding new information to the PCA (i.e. how many
principal components do you need to retain before you aren’t really
explaining any more variance with the additional principal components).
To determine this, you can use the Kaiser-Guttman criterion and produce
a barplot showing at what point the principal components are no longer
explaining significant amount of variance. The code for the barplot
below shows the point at which the variance explained by a new principal
component explains less than the average amount explained by all of the
eigenvalues:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="principal-component-analysis.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the significant axis using the Kaiser-Guttman</span></span>
<span id="cb102-2"><a href="principal-component-analysis.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># criterion</span></span>
<span id="cb102-3"><a href="principal-component-analysis.html#cb102-3" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb102-4"><a href="principal-component-analysis.html#cb102-4" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb102-5"><a href="principal-component-analysis.html#cb102-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb102-6"><a href="principal-component-analysis.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb102-7"><a href="principal-component-analysis.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb102-8"><a href="principal-component-analysis.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="/pca_sigaxes_sp.png" width="500" /></p>
<p>From this barplot, you can see that once you reach PC6, the proportion
of variance explained falls below the average proportion explained by
the other components. If you take another look at the PCA summary, you
will notice that by the time you reach PC5, the cumulative proportion of
variance explained by the principal components is 85%.</p>
<p>A PCA is not just for species data. It can also be run and interpreted
in the same way using standardized environmental variables:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="principal-component-analysis.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the PCA</span></span>
<span id="cb103-2"><a href="principal-component-analysis.html#cb103-2" aria-hidden="true" tabindex="-1"></a>env.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(env.z)  <span class="co"># or rda(env, scale=TRUE)</span></span>
<span id="cb103-3"><a href="principal-component-analysis.html#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="principal-component-analysis.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the results</span></span>
<span id="cb103-5"><a href="principal-component-analysis.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(env.pca)</span>
<span id="cb103-6"><a href="principal-component-analysis.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(env.pca, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Scaling refers to what portion of the PCA is scaled to the eigenvalues.
Scaling = 2 means that the species scores are scaled by eigenvalues,
whereas scaling = 1 means that site scores are scaled by eigenvalues.
Scaling = 3 means that both species and site scores are scaled
symmetrically by square root of eigenvalues. Using scaling = 1 means
that the Euclidean distances among objects (e.g. the rows in your data)
are preserved, whereas scaling = 2 means that the correlations amongst
descriptors (e.g. the columns in this data) are preserved. This means
that when you look at a biplot of a PCA that has been run with
scaling=2, the angle between descriptors represents correlation.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="principal-component-analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the significant axis using the Kaiser-Guttman</span></span>
<span id="cb104-2"><a href="principal-component-analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># criterion</span></span>
<span id="cb104-3"><a href="principal-component-analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb104-4"><a href="principal-component-analysis.html#cb104-4" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb104-5"><a href="principal-component-analysis.html#cb104-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb104-6"><a href="principal-component-analysis.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb104-7"><a href="principal-component-analysis.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb104-8"><a href="principal-component-analysis.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p>Compare this eigenvalue barplot with the one you created for the species
PCA.</p>
<p>As you saw in the explanation of the summary output, a lot of
information can be extracted from a PCA before even plotting it.
However, many of us interpret data best visually and a figure of a PCA
is often the best way to convey major patterns. PCA biplots can be
plotted in base R. A PCA biplot includes the x-axis as the first
Principal Component and the y-axis as the second Principal Component.</p>
<p>For some plotting exercises, let's start with the <em>species PCA</em>. A
basic biplot without any customization could be plotted like this, where
the site positions are shown by black numbers and species’ positions are
shown by red species codes. Remember, species positions come from
plotting species along PCs and the site positions are derived from the
weighted sums of species scores.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="principal-component-analysis.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca)</span></code></pre></div>
<p><img src="/spe_PCA1.png" width="800" /></p>
<p>Basically, the plot above plots the PCA like this:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="principal-component-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>)  <span class="co">#produces a blank biplot with nothing displayed but the axes</span></span>
<span id="cb106-2"><a href="principal-component-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(spe.h.pca, <span class="at">dis =</span> <span class="st">&quot;sp&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)  <span class="co">#points are added for the species (columns) (dis=)</span></span>
<span id="cb106-3"><a href="principal-component-analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use text() instead of points() if you want the labels</span></span>
<span id="cb106-4"><a href="principal-component-analysis.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(spe.h.pca, <span class="at">dis =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  <span class="co">#points are added for the sites (rows)</span></span></code></pre></div>
<p><img src="/spe_PCA2.png" width="800" /></p>
<p>To create more detailed plots and to play with aesthetics, try this
code:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="principal-component-analysis.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Biplot of the PCA on transformed species data (scaling 1)</span></span>
<span id="cb107-2"><a href="principal-component-analysis.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb107-3"><a href="principal-component-analysis.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca)</span>
<span id="cb107-4"><a href="principal-component-analysis.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb107-5"><a href="principal-component-analysis.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca)</span>
<span id="cb107-6"><a href="principal-component-analysis.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb107-7"><a href="principal-component-analysis.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca, <span class="at">scaling=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;none&quot;</span>, <span class="co"># scaling 1 = distance biplot : </span></span>
<span id="cb107-8"><a href="principal-component-analysis.html#cb107-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="co"># distances among objects in the biplot approximate their Euclidean distances</span></span>
<span id="cb107-9"><a href="principal-component-analysis.html#cb107-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="co"># but angles among descriptor vectors DO NOT reflect their correlation</span></span>
<span id="cb107-10"><a href="principal-component-analysis.html#cb107-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;PC1 (%)&quot;</span>, <span class="fu">round</span>((spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)), <span class="co">#this comes from the summary</span></span>
<span id="cb107-11"><a href="principal-component-analysis.html#cb107-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;PC2 (%)&quot;</span>, <span class="fu">round</span>((spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)))</span>
<span id="cb107-12"><a href="principal-component-analysis.html#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(spe.h.pca, <span class="at">display=</span><span class="st">&quot;sites&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">scaling=</span><span class="dv">1</span>),</span>
<span id="cb107-13"><a href="principal-component-analysis.html#cb107-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">bg=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb107-14"><a href="principal-component-analysis.html#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(spe.h.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">1</span>), <span class="at">scaling=</span><span class="dv">1</span>),</span>
<span id="cb107-15"><a href="principal-component-analysis.html#cb107-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scores</span>(spe.h.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">2</span>), <span class="at">scaling=</span><span class="dv">1</span>),</span>
<span id="cb107-16"><a href="principal-component-analysis.html#cb107-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">rownames</span>(<span class="fu">scores</span>(spe.h.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">scaling=</span><span class="dv">1</span>)),</span>
<span id="cb107-17"><a href="principal-component-analysis.html#cb107-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="fl">0.8</span>)  </span></code></pre></div>
<p>This code produces 3 plots, the final plot is the most visually
pleasing: <img src="/spe_PCA3.png" width="800" /></p>
<p>What conclusions can you draw from this plot? From the plot, you can see
the site scores shown by the blue dots. If you superimposed site labels
on top, you could see what sites are closer to each other in terms of
the species found at those sites, but even without the specific labels,
you can see that there are only a few sites that are farther away from
the majority. The species names are shown by their names in red and from
the plot, you can see for example that the species "ABL" is not found
or not found in the same prevalence in the majority of sites as other
species closer to the centre of the ordination.</p>
<p>Biplots need to be interpreted in terms of angles from center of plot,
not just in terms of proximity. Two variables at 90 degree angle are
uncorrelated. Two variables in opposing directions are negatively
correlated. Two variables very close together are strongly correlated,
at least in the space described by these axes.</p>
<p>Now let's look at a plot of the <em>environmental PCA</em>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="principal-component-analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Biplot of the PCA on the environmental variables (scaling 2)</span></span>
<span id="cb108-2"><a href="principal-component-analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb108-3"><a href="principal-component-analysis.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env.pca)</span>
<span id="cb108-4"><a href="principal-component-analysis.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb108-5"><a href="principal-component-analysis.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env.pca, <span class="at">scaling=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;none&quot;</span>, <span class="co"># scaling 2 = correlation biplot : </span></span>
<span id="cb108-6"><a href="principal-component-analysis.html#cb108-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="co"># distances among abjects in the biplot DO NOT approximate their Euclidean distances</span></span>
<span id="cb108-7"><a href="principal-component-analysis.html#cb108-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="co"># but angles among descriptor vectors reflect their correlation</span></span>
<span id="cb108-8"><a href="principal-component-analysis.html#cb108-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;PC1 (%)&quot;</span>, <span class="fu">round</span>((env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)),</span>
<span id="cb108-9"><a href="principal-component-analysis.html#cb108-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;PC2 (%)&quot;</span>, <span class="fu">round</span>((env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)),</span>
<span id="cb108-10"><a href="principal-component-analysis.html#cb108-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb108-11"><a href="principal-component-analysis.html#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(env.pca, <span class="at">display=</span><span class="st">&quot;sites&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">scaling=</span><span class="dv">2</span>), </span>
<span id="cb108-12"><a href="principal-component-analysis.html#cb108-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">bg=</span><span class="st">&quot;darkgreen&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb108-13"><a href="principal-component-analysis.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(env.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">1</span>), <span class="at">scaling=</span><span class="dv">2</span>),</span>
<span id="cb108-14"><a href="principal-component-analysis.html#cb108-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scores</span>(env.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">2</span>), <span class="at">scaling=</span><span class="dv">2</span>),</span>
<span id="cb108-15"><a href="principal-component-analysis.html#cb108-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">rownames</span>(<span class="fu">scores</span>(env.pca, <span class="at">display=</span><span class="st">&quot;species&quot;</span>, <span class="at">scaling=</span><span class="dv">2</span>)),</span>
<span id="cb108-16"><a href="principal-component-analysis.html#cb108-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="/env_PCA1.png" width="800" /></p>
<p>Remember that a PCA biplot is really just a scatter plot, where the axes
are scores extracted from composite variables. This means that there are
many different ways you can plot a PCA. For example, try using your
ggplot() skills from Workshop 4 to extract PCA scores and plot an
ordination in ggplot.</p>
<p><strong>Use of PCA axis as composite explanatory variables:</strong></p>
<p>In some cases, users want to reduce several environmental variables in a
few numbers of composite variables. When PCA axes represent ecological
gradients (i.e. when environmental variables are correlated with PCA
axis in a meaningful way), users can use site scores along PCA Axis in
further analyses instead of the raw environmental data. In other words,
sites scores along PCA Axis represent linear combinations of descriptors
and can consequently be used as proxy of ecological conditions in
“post-ordination” analyses. In the example above, the first PCA axis can
be related to a gradient from oligotrophic, oxygen-rich to eutrophic,
oxygen-deprived water: from left to right, a first group display the
highest values of altitude (alt) and slope (pen), and the lowest values
in river discharge (deb) and distance from the source (das). The second
group of sites has the highest values in oxygen content (oxy) and the
lowest in nitrate concentration (nit). A third group shows intermediate
values in almost all the measured variables. If users are then
interested in identifying if a specific species is associated with
ologotrophic or eutrophic water, one can correlate the species
abundances to sites scores along PCA Axis 1. For example, if one want to
assess if the species TRU prefers oligotrophic or eutrophic water, the
following linear model can be used :</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="principal-component-analysis.html#cb109-1" aria-hidden="true" tabindex="-1"></a>Sites_scores_Env_Axis1 <span class="ot">&lt;-</span> <span class="fu">scores</span>(env.pca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>,</span>
<span id="cb109-2"><a href="principal-component-analysis.html#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">scaling =</span> <span class="dv">2</span>)</span>
<span id="cb109-3"><a href="principal-component-analysis.html#cb109-3" aria-hidden="true" tabindex="-1"></a>spe<span class="sc">$</span>ANG</span>
<span id="cb109-4"><a href="principal-component-analysis.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Sites_scores_Env_Axis1, spe<span class="sc">$</span>TRU)</span>
<span id="cb109-5"><a href="principal-component-analysis.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(spe<span class="sc">$</span>TRU <span class="sc">~</span> Sites_scores_Env_Axis1))</span>
<span id="cb109-6"><a href="principal-component-analysis.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(spe<span class="sc">$</span>TRU <span class="sc">~</span> Sites_scores_Env_Axis1))</span></code></pre></div>
<p>This simple model shows that the abundance of species TRU is
significantly dependent of site scores along PCA axis 1 (t = -5.30, p =
1.35e-05, adj-R2 = 49.22%), i.e. depends of an oligotrophic-eutrophic
gradient. The following plot identifies a preference of this species for
oligotrophic water.</p>
<p><strong>Challenge 3</strong> Run a PCA of the “mite” species abundance data. What are
the significant axes of variation? Which groups of sites can you
identify? Which species are related to each group of sites? Use:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="principal-component-analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a>mite.spe <span class="ot">&lt;-</span> mite  <span class="co">#mite data is from the vegan package</span></span></code></pre></div>
<p><strong>Challenge 3 - Solution</strong> &lt;hidden&gt; Your code likely looks something
like the following.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="principal-component-analysis.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hellinger transformation of mite data and PCA</span></span>
<span id="cb111-2"><a href="principal-component-analysis.html#cb111-2" aria-hidden="true" tabindex="-1"></a>mite.spe.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(mite.spe, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb111-3"><a href="principal-component-analysis.html#cb111-3" aria-hidden="true" tabindex="-1"></a>mite.spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(mite.spe.hel)</span>
<span id="cb111-4"><a href="principal-component-analysis.html#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="principal-component-analysis.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the significant axes?</span></span>
<span id="cb111-6"><a href="principal-component-analysis.html#cb111-6" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb111-7"><a href="principal-component-analysis.html#cb111-7" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb111-8"><a href="principal-component-analysis.html#cb111-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb111-9"><a href="principal-component-analysis.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb111-10"><a href="principal-component-analysis.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb111-11"><a href="principal-component-analysis.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb111-12"><a href="principal-component-analysis.html#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="principal-component-analysis.html#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Output summary/results</span></span>
<span id="cb111-14"><a href="principal-component-analysis.html#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mite.spe.h.pca, <span class="at">display =</span> <span class="cn">NULL</span>)</span>
<span id="cb111-15"><a href="principal-component-analysis.html#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">windows</span>()</span>
<span id="cb111-16"><a href="principal-component-analysis.html#cb111-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-17"><a href="principal-component-analysis.html#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the biplot</span></span>
<span id="cb111-18"><a href="principal-component-analysis.html#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mite.spe.h.pca, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>, <span class="at">xlab =</span> <span class="fu">c</span>(<span class="st">&quot;PC1 (%)&quot;</span>,</span>
<span id="cb111-19"><a href="principal-component-analysis.html#cb111-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb111-20"><a href="principal-component-analysis.html#cb111-20" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>, <span class="dv">2</span>)), <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;PC2 (%)&quot;</span>, <span class="fu">round</span>((mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig)) <span class="sc">*</span></span>
<span id="cb111-21"><a href="principal-component-analysis.html#cb111-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>, <span class="dv">2</span>)))</span>
<span id="cb111-22"><a href="principal-component-analysis.html#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">scores</span>(mite.spe.h.pca, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb111-23"><a href="principal-component-analysis.html#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">1</span>), <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb111-24"><a href="principal-component-analysis.html#cb111-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb111-25"><a href="principal-component-analysis.html#cb111-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">scores</span>(mite.spe.h.pca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb111-26"><a href="principal-component-analysis.html#cb111-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="dv">1</span>), <span class="fu">scores</span>(mite.spe.h.pca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>,</span>
<span id="cb111-27"><a href="principal-component-analysis.html#cb111-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">scores</span>(mite.spe.h.pca,</span>
<span id="cb111-28"><a href="principal-component-analysis.html#cb111-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">display =</span> <span class="st">&quot;species&quot;</span>, <span class="at">scaling =</span> <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p>And your resulting biplot likely looks something like this:</p>
<p><img src="/mite_pca.png" width="800" /></p>
<p>A dense cluster of related species and sites can be seen in the biplot.
&lt;/hidden&gt;</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="what-does-unconstrained-mean.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correspondence-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
