<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Principal Component Analysis | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="what-does-unconstrained-mean.html"/>
<link rel="next" href="correspondence-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>PREAMBLE</b></span></li>
<li class="chapter" data-level="3" data-path="recap-univariate-analyses.html"><a href="recap-univariate-analyses.html"><i class="fa fa-check"></i><b>3</b> Recap: Univariate analyses</a></li>
<li class="chapter" data-level="4" data-path="intro-multivariate-analyses.html"><a href="intro-multivariate-analyses.html"><i class="fa fa-check"></i><b>4</b> Intro: Multivariate analyses</a></li>
<li class="chapter" data-level="5" data-path="setting-up-our-goals.html"><a href="setting-up-our-goals.html"><i class="fa fa-check"></i><b>5</b> Setting up our goals</a></li>
<li class="chapter" data-level="6" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html"><i class="fa fa-check"></i><b>6</b> Matrix algebra, very briefly</a>
<ul>
<li class="chapter" data-level="6.1" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#data-sets-are-matrices"><i class="fa fa-check"></i><b>6.1</b> Data sets <em>are</em> matrices</a></li>
<li class="chapter" data-level="6.2" data-path="matrix-algebra-very-briefly.html"><a href="matrix-algebra-very-briefly.html#association-matrices"><i class="fa fa-check"></i><b>6.2</b> Association matrices</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>7</b> Exploring the dataset</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-fish-communities"><i class="fa fa-check"></i><b>7.1</b> Doubs river fish communities</a></li>
<li class="chapter" data-level="7.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#doubs-river-environmental-data"><i class="fa fa-check"></i><b>7.2</b> Doubs river environmental data</a></li>
</ul></li>
<li class="part"><span><b>(Dis)similarity measures</b></span></li>
<li class="chapter" data-level="8" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>8</b> <code>dist()</code></a></li>
<li class="chapter" data-level="9" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html"><i class="fa fa-check"></i><b>9</b> Types of distance coefficients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#metric-distances"><i class="fa fa-check"></i><b>9.1</b> Metric distances</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#euclidean-distances"><i class="fa fa-check"></i><b>9.1.1</b> Euclidean distances</a></li>
<li class="chapter" data-level="9.1.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#challenge-1"><i class="fa fa-check"></i><b>9.1.2</b> Challenge #1</a></li>
<li class="chapter" data-level="9.1.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#chord-distances"><i class="fa fa-check"></i><b>9.1.3</b> Chord distances</a></li>
<li class="chapter" data-level="9.1.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#jaccards-coefficient"><i class="fa fa-check"></i><b>9.1.4</b> Jaccard’s coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#semimetric-distances"><i class="fa fa-check"></i><b>9.2</b> Semimetric distances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#sørensens-coefficient"><i class="fa fa-check"></i><b>9.2.1</b> Sørensen’s coefficient</a></li>
<li class="chapter" data-level="9.2.2" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#bray-curtis-coefficient"><i class="fa fa-check"></i><b>9.2.2</b> Bray-Curtis’ coefficient</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#nonmetric-distances"><i class="fa fa-check"></i><b>9.3</b> Nonmetric distances</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#mahalanobis-distance"><i class="fa fa-check"></i><b>9.3.1</b> Mahalanobis distance</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="types-of-distance-coefficients.html"><a href="types-of-distance-coefficients.html#representing-distance-matrices"><i class="fa fa-check"></i><b>9.4</b> Representing distance matrices</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>10</b> Transformations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transformations.html"><a href="transformations.html#presence-absence-transformation"><i class="fa fa-check"></i><b>10.1</b> Presence-absence transformation</a></li>
<li class="chapter" data-level="10.2" data-path="transformations.html"><a href="transformations.html#species-profiles-transformation"><i class="fa fa-check"></i><b>10.2</b> Species profiles transformation</a></li>
<li class="chapter" data-level="10.3" data-path="transformations.html"><a href="transformations.html#hellinger-transformation"><i class="fa fa-check"></i><b>10.3</b> Hellinger transformation</a></li>
<li class="chapter" data-level="10.4" data-path="transformations.html"><a href="transformations.html#z-score-standardization"><i class="fa fa-check"></i><b>10.4</b> Z-score standardization</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="transformations.html"><a href="transformations.html#other-association-metrics"><i class="fa fa-check"></i><b>10.4.1</b> Other association metrics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Clustering</b></span></li>
<li class="chapter" data-level="11" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>11</b> Clustering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clustering.html"><a href="clustering.html#single-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.1</b> Single linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.2" data-path="clustering.html"><a href="clustering.html#complete-linkage-agglomerative-clustering"><i class="fa fa-check"></i><b>11.2</b> Complete linkage agglomerative clustering</a></li>
<li class="chapter" data-level="11.3" data-path="clustering.html"><a href="clustering.html#unweighted-pair-group-method-with-arithmetic-mean-upgma"><i class="fa fa-check"></i><b>11.3</b> Unweighted Pair Group Method with Arithmetic Mean (UPGMA)</a></li>
<li class="chapter" data-level="11.4" data-path="clustering.html"><a href="clustering.html#weighted-pair-group-method-with-arithmetic-mean-wpgma"><i class="fa fa-check"></i><b>11.4</b> Weighted Pair Group Method with Arithmetic Mean (WPGMA)</a></li>
<li class="chapter" data-level="11.5" data-path="clustering.html"><a href="clustering.html#wards-minimum-variance"><i class="fa fa-check"></i><b>11.5</b> Ward’s minimum variance</a></li>
<li class="chapter" data-level="11.6" data-path="clustering.html"><a href="clustering.html#deciding-on-cut-off-points"><i class="fa fa-check"></i><b>11.6</b> Deciding on cut-off points</a></li>
<li class="chapter" data-level="11.7" data-path="clustering.html"><a href="clustering.html#playing-with-real-data-the-doubs-fish-species-data"><i class="fa fa-check"></i><b>11.7</b> Playing with real data: the Doubs fish species data</a></li>
</ul></li>
<li class="part"><span><b>Unconstrained Ordination</b></span></li>
<li class="chapter" data-level="12" data-path="what-does-unconstrained-mean.html"><a href="what-does-unconstrained-mean.html"><i class="fa fa-check"></i><b>12</b> What does “unconstrained” mean?</a></li>
<li class="chapter" data-level="13" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-not-in-a-nutshell"><i class="fa fa-check"></i><b>13.1</b> Principal component analysis <em>not</em> in a nutshell</a></li>
<li class="chapter" data-level="13.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-using-package-functions"><i class="fa fa-check"></i><b>13.2</b> Principal component analysis using package functions</a></li>
<li class="chapter" data-level="13.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principal-component-analysis-on-ecological-data"><i class="fa fa-check"></i><b>13.3</b> Principal component analysis on ecological data</a></li>
<li class="chapter" data-level="13.4" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#condensing-data-with-principal-component-analysis"><i class="fa fa-check"></i><b>13.4</b> Condensing data with principal component analysis</a></li>
<li class="chapter" data-level="13.5" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#scaling"><i class="fa fa-check"></i><b>13.5</b> Scaling</a></li>
<li class="chapter" data-level="13.6" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#challenge-2"><i class="fa fa-check"></i><b>13.6</b> Challenge #2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>14</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="15" data-path="principal-coordinates-analysis.html"><a href="principal-coordinates-analysis.html"><i class="fa fa-check"></i><b>15</b> Principal Coordinates Analysis</a></li>
<li class="chapter" data-level="16" data-path="nonmetric-multidimensional-scaling.html"><a href="nonmetric-multidimensional-scaling.html"><i class="fa fa-check"></i><b>16</b> Nonmetric MultiDimensional Scaling</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="17" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>17</b> Summary</a></li>
<li class="chapter" data-level="18" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18</b> Additional resources</a></li>
<li class="chapter" data-level="19" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>19</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="principal-component-analysis" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Principal Component Analysis<a href="principal-component-analysis.html#principal-component-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Principal Component Analysis (PCA) is a statistical technique used to reduce the dimensionality of a dataset while retaining most of its variability. It is a linear transformation method that converts the original set of variables into a new set of linearly uncorrelated variables, called principal components (PCs), which are sorted in decreasing order of variance.</p>
<p>PCA was first introduced by Karl Pearson in 1901, who developed the mathematical foundation for the method. Later, Harold Hotelling (1933) provided a more detailed and modern interpretation of the PCA method.</p>
<p>PCA has become one of the most commonly used techniques in data analysis due to its ability to identify hidden patterns and reduce the complexity of high-dimensional data.</p>
<p>In essence, PCA aims to find the linear combinations of the original variables that account for the largest possible amount of variation in the dataset. The resulting principal components are orthogonal to each other, meaning that they are not correlated, and their order reflects their importance in explaining the variability of the data.</p>
<p>To become comfortable with PCA, we will follow with detailed examples on how to perform it step-by-step, and then we will use functions from R packages to do it.</p>
<div id="principal-component-analysis-not-in-a-nutshell" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Principal component analysis <em>not</em> in a nutshell<a href="principal-component-analysis.html#principal-component-analysis-not-in-a-nutshell" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have a dataset with <span class="math inline">\(n\)</span> observations and <span class="math inline">\(p\)</span> variables represented by an n x p matrix <span class="math inline">\(X\)</span>. The goal of PCA is to transform this dataset into a new set of <span class="math inline">\(p\)</span> uncorrelated variables, called principal components (PCs), which capture the maximum amount of variance in the original data.</p>
<div id="load-data" class="section level4 hasAnchor" number="13.1.0.1">
<h4><span class="header-section-number">13.1.0.1</span> Load data<a href="principal-component-analysis.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this workshop, we use the <code>data(varechem)</code> dataset, which contains measurements of chemical properties of 18 soil samples from a field experiment. We will select the first two variables:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="principal-component-analysis.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets package</span></span>
<span id="cb95-2"><a href="principal-component-analysis.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb95-3"><a href="principal-component-analysis.html#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="principal-component-analysis.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the varechem dataset</span></span>
<span id="cb95-5"><a href="principal-component-analysis.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)</span>
<span id="cb95-6"><a href="principal-component-analysis.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="principal-component-analysis.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select data</span></span>
<span id="cb95-8"><a href="principal-component-analysis.html#cb95-8" aria-hidden="true" tabindex="-1"></a>(data <span class="ot">&lt;-</span> varechem[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div>
<pre><code>##       N    P
## 18 19.8 42.1
## 15 13.4 39.1
## 24 20.2 67.7
## 27 20.6 60.8
## 23 23.8 54.5
## 19 22.8 40.9
## 22 26.6 36.7
## 16 24.2 31.0
## 28 29.8 73.5
## 13 28.1 40.5
## 14 21.8 38.1
## 20 26.2 61.9
## 25 22.8 50.6
## 7  30.5 24.6
## 5  33.1 22.7
## 6  19.1 26.4
## 3  31.1 32.3
## 4  18.0 64.9
## 2  22.3 47.4
## 9  15.0 48.4
## 12 16.0 32.7
## 10 14.3 62.8
## 11 16.7 55.8
## 21 21.0 26.5</code></pre>
</div>
<div id="standardize-data" class="section level4 hasAnchor" number="13.1.0.2">
<h4><span class="header-section-number">13.1.0.2</span> Standardize data<a href="principal-component-analysis.html#standardize-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We first need to standardize the data to have mean zero and unit variance:</p>
<p><span class="math display">\[ Z_{ij} = \frac{X_{ij} - \bar{X_j}}{s_j} \]</span></p>
<p>where Z is the standardized matrix, X is the original matrix, <span class="math inline">\(\bar{X_j}\)</span> is the mean of variable j, and <span class="math inline">\(s_j\)</span> is the standard deviation of variable j.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="principal-component-analysis.html#cb97-1" aria-hidden="true" tabindex="-1"></a>data_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(data)</span></code></pre></div>
</div>
<div id="compute-the-covariance-matrix" class="section level4 hasAnchor" number="13.1.0.3">
<h4><span class="header-section-number">13.1.0.3</span> Compute the covariance matrix<a href="principal-component-analysis.html#compute-the-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, we compute the covariance matrix of <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[ C = \frac{1}{n-1}ZZ^T \]</span></p>
<p>where <span class="math inline">\(C\)</span> is the covariance matrix and <span class="math inline">\(T\)</span> denotes the transpose operation.</p>
<p>The covariance matrix is a symmetric matrix that represents the pairwise covariances between the variables. The formula for the covariance between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is:</p>
<p><span class="math display">\[\text{Cov}(X,Y) = \frac{1}{n-1}\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> are the values of the variables for observation $i$, and <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\bar{Y}\)</span> are the sample means of the variables.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="principal-component-analysis.html#cb98-1" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(data_std)</span></code></pre></div>
</div>
<div id="perform-the-eigendecomposition-of-the-covariance-matrix" class="section level4 hasAnchor" number="13.1.0.4">
<h4><span class="header-section-number">13.1.0.4</span> Perform the Eigendecomposition of the covariance matrix<a href="principal-component-analysis.html#perform-the-eigendecomposition-of-the-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Then, we calculate the eigenvalues and eigenvectors of <span class="math inline">\(C\)</span>:</p>
<p><span class="math display">\[ Cv = \lambda v \]</span></p>
<p>where <span class="math inline">\(C\)</span> is the covariance matrix, <span class="math inline">\(v\)</span> is the eigenvector and <span class="math inline">\(\lambda\)</span> is the corresponding eigenvalue.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="principal-component-analysis.html#cb99-1" aria-hidden="true" tabindex="-1"></a>eigen_decomp <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_matrix)</span>
<span id="cb99-2"><a href="principal-component-analysis.html#cb99-2" aria-hidden="true" tabindex="-1"></a>Eigenvalues <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>values</span>
<span id="cb99-3"><a href="principal-component-analysis.html#cb99-3" aria-hidden="true" tabindex="-1"></a>Eigenvectors <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>vectors</span></code></pre></div>
<p>The eigenvectors represent the directions in the <span class="math inline">\(p\)</span>-dimensional space that capture the maximum amount of variance in the data, and the eigenvalues indicate the amount of variance captured by each eigenvector.</p>
</div>
<div id="project-the-standardized-data-onto-the-eigenspace" class="section level4 hasAnchor" number="13.1.0.5">
<h4><span class="header-section-number">13.1.0.5</span> Project the standardized data onto the Eigenspace<a href="principal-component-analysis.html#project-the-standardized-data-onto-the-eigenspace" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we project the standardized data matrix <span class="math inline">\(Z\)</span> onto the new basis vectors to obtain the principal components. Here, we’ll calculate the principal component scores by multiplying the standardized data by the eigenvectors of all principal components:</p>
<p><span class="math display">\[ Y = ZV \]</span></p>
<p>where <span class="math inline">\(Y\)</span> is the transformed data matrix, and <span class="math inline">\(V\)</span> is the matrix of eigenvectors.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="principal-component-analysis.html#cb100-1" aria-hidden="true" tabindex="-1"></a>F_PrComps <span class="ot">&lt;-</span> data_std <span class="sc">%*%</span> Eigenvectors</span>
<span id="cb100-2"><a href="principal-component-analysis.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="principal-component-analysis.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(F_PrComps)</span></code></pre></div>
<pre><code>##          [,1]       [,2]
## 18  0.1894957  0.4713816
## 15  0.8662023  1.4319452
## 24  1.3494546 -0.7909067
## 27  0.9718543 -0.5156358
## 23  0.2644868 -0.6269034
## 19 -0.2510109  0.1444178</code></pre>
<p>The score matrix, <span class="math inline">\(F\)</span>, (object <code>F_PrComps</code>) allows one to <em>rotate</em> the new data space, so it is represented in relation to the principal components. For instance, see the figure below:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-63"></span>
<img src="book-en_files/figure-html/unnamed-chunk-63-1.png" alt="Relationship between N and P from the `varechem` dataset. The purple and orange diagonal lines represent the first and second principal components, respectively. Purple lines denote the residuals between the data point and the first principal component, while orange segmented lines denote the distance between points and the second principal componenet. Arrows indicate the Eigenvalues (direction) from the principal component analysis done on these two variables." width="336" />
<p class="caption">
Figure 13.1: Relationship between N and P from the <code>varechem</code> dataset. The purple and orange diagonal lines represent the first and second principal components, respectively. Purple lines denote the residuals between the data point and the first principal component, while orange segmented lines denote the distance between points and the second principal componenet. Arrows indicate the Eigenvalues (direction) from the principal component analysis done on these two variables.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-64"></span>
<img src="book-en_files/figure-html/unnamed-chunk-64-1.png" alt="Relationship between PC1 and PC2 from the principal component analysis done on the P and N variables from the `varechem` dataset. The purple and orange lines represent the first and second principal components, respectively. Purple lines denote the residuals between the data point and the first principal component, while orange segmented lines denote the distance between points and the second principal componenet." width="336" />
<p class="caption">
Figure 13.2: Relationship between PC1 and PC2 from the principal component analysis done on the P and N variables from the <code>varechem</code> dataset. The purple and orange lines represent the first and second principal components, respectively. Purple lines denote the residuals between the data point and the first principal component, while orange segmented lines denote the distance between points and the second principal componenet.
</p>
</div>
</div>
</div>
<div id="principal-component-analysis-using-package-functions" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Principal component analysis using package functions<a href="principal-component-analysis.html#principal-component-analysis-using-package-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>PCA can also be computed using the <code>stats::prcomp()</code>, <code>stats::princomp()</code>, <code>vegan::rda()</code>, and <code>ade4::dudi.pca()</code> functions.</p>
<p>In a nutshell, this is what we have done:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="principal-component-analysis.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)</span>
<span id="cb102-2"><a href="principal-component-analysis.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="principal-component-analysis.html#cb102-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> varechem[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb102-4"><a href="principal-component-analysis.html#cb102-4" aria-hidden="true" tabindex="-1"></a>Y_std <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(Y))</span>
<span id="cb102-5"><a href="principal-component-analysis.html#cb102-5" aria-hidden="true" tabindex="-1"></a>Y_R <span class="ot">&lt;-</span> <span class="fu">cov</span>(Y_std)</span>
<span id="cb102-6"><a href="principal-component-analysis.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="principal-component-analysis.html#cb102-7" aria-hidden="true" tabindex="-1"></a>Eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Y_R)<span class="sc">$</span>values</span>
<span id="cb102-8"><a href="principal-component-analysis.html#cb102-8" aria-hidden="true" tabindex="-1"></a>Eigenvectors <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Y_R)<span class="sc">$</span>vectors</span>
<span id="cb102-9"><a href="principal-component-analysis.html#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="principal-component-analysis.html#cb102-10" aria-hidden="true" tabindex="-1"></a>F_PrComps <span class="ot">&lt;-</span> Y_std <span class="sc">%*%</span> Eigenvectors</span>
<span id="cb102-11"><a href="principal-component-analysis.html#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="principal-component-analysis.html#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(F_PrComps)</span></code></pre></div>
<pre><code>##          [,1]       [,2]
## 18  0.1894957  0.4713816
## 15  0.8662023  1.4319452
## 24  1.3494546 -0.7909067
## 27  0.9718543 -0.5156358
## 23  0.2644868 -0.6269034
## 19 -0.2510109  0.1444178</code></pre>
<p>How, how does it compare to <code>stats::prcomp()</code>?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="principal-component-analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a>PCA_prcomp <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(Y, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-2"><a href="principal-component-analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="principal-component-analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or PCA_prcomp &lt;- prcomp(Y_std)</span></span>
<span id="cb104-4"><a href="principal-component-analysis.html#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="principal-component-analysis.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PCA_prcomp<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>##           PC1        PC2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034
## 19  0.2510109 -0.1444178</code></pre>
<p>And, how does it compare to <code>stats::princomp()</code>?</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="principal-component-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a>PCA_princomp <span class="ot">&lt;-</span> <span class="fu">princomp</span>(Y_std)</span>
<span id="cb106-2"><a href="principal-component-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="principal-component-analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PCA_princomp<span class="sc">$</span>scores)</span></code></pre></div>
<pre><code>##        Comp.1     Comp.2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034
## 19  0.2510109 -0.1444178</code></pre>
<p>And to <code>vegan::rda()</code>?</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="principal-component-analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a>PCA_vegan_rda <span class="ot">&lt;-</span> <span class="fu">rda</span>(Y_std)</span>
<span id="cb108-2"><a href="principal-component-analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="principal-component-analysis.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scores</span>(PCA_vegan_rda, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">choices =</span> <span class="fu">seq_len</span>(PCA_vegan_rda<span class="sc">$</span>CA<span class="sc">$</span>rank),</span>
<span id="cb108-4"><a href="principal-component-analysis.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const =</span> <span class="fu">sqrt</span>(PCA_vegan_rda<span class="sc">$</span>tot.chi <span class="sc">*</span> (<span class="fu">nrow</span>(PCA_vegan_rda<span class="sc">$</span>CA<span class="sc">$</span>u) <span class="sc">-</span></span>
<span id="cb108-5"><a href="principal-component-analysis.html#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>)))[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>##           PC1        PC2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034</code></pre>
<p><code>vegan::rda()</code> is a bit special. It uses alternative scalings. We will not cover them here, but you can study the <code>vignette("decision-vegan")</code>.</p>
</div>
<div id="principal-component-analysis-on-ecological-data" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Principal component analysis on ecological data<a href="principal-component-analysis.html#principal-component-analysis-on-ecological-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have implemented PCA on a two-variables dataset, for simplicity.</p>
<p>Let us advance and apply it to our fish species dataset.</p>
<p>For this, we will use the <code>vegan::rda()</code> function on the <em>Hellinger-transformed</em> fish data and summarise the results:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="principal-component-analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a>spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(spe.hel)</span>
<span id="cb110-2"><a href="principal-component-analysis.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="principal-component-analysis.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(spe.h.pca)</span></span></code></pre></div>
<p>The first lines of <code>summary.rda()</code> tell us about the <em>Total variance</em> and <em>Unconstrained variance</em> in our model.</p>
<pre><code>## [1] &quot;Partitioning of variance:&quot;        &quot;              Inertia Proportion&quot;
## [3] &quot;Total          0.5023          1&quot; &quot;Unconstrained  0.5023          1&quot;</code></pre>
<pre><code>## [1] &quot;Importance of components:&quot;                                                    
## [2] &quot;                         PC1     PC2     PC3     PC4     PC5     PC6     PC7&quot; 
## [3] &quot;Eigenvalue            0.2491 0.06592 0.04615 0.03723 0.02125 0.01662 0.01477&quot; 
## [4] &quot;Proportion Explained  0.4959 0.13122 0.09188 0.07412 0.04230 0.03309 0.02940&quot; 
## [5] &quot;Cumulative Proportion 0.4959 0.62715 0.71903 0.79315 0.83544 0.86853 0.89794&quot; 
## [6] &quot;                          PC14     PC15     PC16     PC17      PC18      PC19&quot;
## [7] &quot;Eigenvalue            0.002612 0.001505 0.001387 0.001037 0.0007815 0.0004749&quot;
## [8] &quot;Proportion Explained  0.005200 0.002996 0.002761 0.002065 0.0015557 0.0009454&quot;
## [9] &quot;Cumulative Proportion 0.987229 0.990225 0.992986 0.995051 0.9966069 0.9975523&quot;</code></pre>
<p>This is followed by the <em>Eigenvalues</em>, and their contribution to the variance.</p>
<p>In fact, if we sum all our <em>Eigenvalues</em>, we will obtain the amount of uncostrained variance explained by the analysis!</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="principal-component-analysis.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig)</span></code></pre></div>
<pre><code>## [1] 0.5023429</code></pre>
<p>The next information is related to the <em>scaling</em>, to the <em>species scores</em>, and to the <em>site scores</em>.</p>
<pre><code>##  [1] &quot;Eigenvalue            0.0004263 0.0002812 0.0002188 0.0001382 0.0000876&quot;
##  [2] &quot;Proportion Explained  0.0008487 0.0005598 0.0004356 0.0002752 0.0001744&quot;
##  [3] &quot;Cumulative Proportion 0.9984010 0.9989608 0.9993965 0.9996717 0.9998460&quot;
##  [4] &quot;                           PC25      PC26      PC27&quot;                    
##  [5] &quot;Proportion Explained  1.062e-04 2.938e-05 1.835e-05&quot;                    
##  [6] &quot;Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00&quot;                    
##  [7] &quot;Scaling 2 for species and site scores&quot;                                  
##  [8] &quot;* Species are scaled proportional to eigenvalues&quot;                       
##  [9] &quot;* Sites are unscaled: weighted dispersion equal on all dimensions&quot;      
## [10] &quot;* General scaling constant of scores:  1.953663 &quot;                       
## [11] &quot;&quot;                                                                       
## [12] &quot;&quot;                                                                       
## [13] &quot;Species scores&quot;                                                         
## [14] &quot;BCO -0.20055  0.08332 -0.074787 -0.0504875  0.073890  0.0249842&quot;        
## [15] &quot;PCH -0.14626  0.05268 -0.072012 -0.0432572  0.050318  0.0178776&quot;        
## [16] &quot;GAR -0.35085 -0.09353  0.198664  0.0178669  0.023796 -0.0971362&quot;        
## [17] &quot;BBO -0.24167  0.03598 -0.079528 -0.0339049  0.096690  0.0620979&quot;        
## [18] &quot;ABL -0.42269 -0.22879  0.007158  0.1128353  0.006759  0.1248913&quot;        
## [19] &quot;ANG -0.20521  0.11557 -0.072060 -0.0159902  0.072030 -0.0003801&quot;        
## [20] &quot;&quot;                                                                       
## [21] &quot;&quot;                                                                       
## [22] &quot;Site scores (weighted sums of species scores)&quot;</code></pre>
<p><em>Species</em> refer to your descriptors (i.e. the columns in your dataset), which here are the fish species.</p>
<p><em>Scores</em> refer to the position of every species along the principal components.</p>
<pre><code>## [1] &quot;Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00&quot;              
## [2] &quot;Scaling 2 for species and site scores&quot;                            
## [3] &quot;* Species are scaled proportional to eigenvalues&quot;                 
## [4] &quot;* Sites are unscaled: weighted dispersion equal on all dimensions&quot;
## [5] &quot;* General scaling constant of scores:  1.953663 &quot;                 
## [6] &quot;&quot;                                                                 
## [7] &quot;&quot;                                                                 
## [8] &quot;Species scores&quot;</code></pre>
<pre><code>## [1] &quot;PCH -0.14626  0.05268 -0.072012 -0.0432572  0.050318  0.0178776&quot;
## [2] &quot;GAR -0.35085 -0.09353  0.198664  0.0178669  0.023796 -0.0971362&quot;
## [3] &quot;BBO -0.24167  0.03598 -0.079528 -0.0339049  0.096690  0.0620979&quot;
## [4] &quot;ABL -0.42269 -0.22879  0.007158  0.1128353  0.006759  0.1248913&quot;
## [5] &quot;ANG -0.20521  0.11557 -0.072060 -0.0159902  0.072030 -0.0003801&quot;
## [6] &quot;&quot;                                                               
## [7] &quot;&quot;                                                               
## [8] &quot;Site scores (weighted sums of species scores)&quot;</code></pre>
<p><em>Sites</em> represent the rows in your dataset, which here are the different sites along the <em>Doubs</em> river.</p>
<p>This information can be obtained with the <code>score()</code> function that we used before:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="principal-component-analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scores</span>(spe.h.pca,</span>
<span id="cb118-2"><a href="principal-component-analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">display =</span> <span class="st">&quot;species&quot;</span> or <span class="st">&quot;sites&quot;</span>)</span></code></pre></div>
</div>
<div id="condensing-data-with-principal-component-analysis" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Condensing data with principal component analysis<a href="principal-component-analysis.html#condensing-data-with-principal-component-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we have 27 principal components. However, we can apply algorithms to select the lowest number of principal components that still account for a large variance in the data.</p>
<div id="kaiser-guttman-criterion" class="section level4 hasAnchor" number="13.4.0.1">
<h4><span class="header-section-number">13.4.0.1</span> Kaiser-Guttman criterion<a href="principal-component-analysis.html#kaiser-guttman-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can select the principal components that capture more variance than the average explanation of all principal components. We do this by:</p>
<ol style="list-style-type: decimal">
<li><p>Extracting the <em>Eigenvalues</em> associated to the principal components;</p></li>
<li><p>Subsetting the <em>Eigenvalues</em> above the mean <em>Eigenvalue</em>:</p></li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="principal-component-analysis.html#cb119-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb119-2"><a href="principal-component-analysis.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ev[ev &gt; mean(ev)]</span></span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="principal-component-analysis.html#cb120-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb120-2"><a href="principal-component-analysis.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb120-3"><a href="principal-component-analysis.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb120-4"><a href="principal-component-analysis.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>,</span>
<span id="cb120-5"><a href="principal-component-analysis.html#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-78-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="broken-stick-model" class="section level4 hasAnchor" number="13.4.0.2">
<h4><span class="header-section-number">13.4.0.2</span> Broken-stick model<a href="principal-component-analysis.html#broken-stick-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The broken-stick model retains components that explain more variance than would be expected by randomly dividing the variance into <span class="math inline">\(p\)</span> parts.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="principal-component-analysis.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">bstick</span>(spe.h.pca))</span></code></pre></div>
<pre><code>##        PC1        PC2        PC3        PC4        PC5        PC6 
## 0.07240169 0.05379640 0.04449375 0.03829199 0.03364067 0.02991961</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="principal-component-analysis.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(spe.h.pca, <span class="at">bstick =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;lines&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-80-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="scaling" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Scaling<a href="principal-component-analysis.html#scaling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All that is left is to discuss <em>scaling</em> and to <em>visualize</em> our results.</p>
<p>Let us practice and compute a PCA on the standardized environmental variables for the same dataset.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="principal-component-analysis.html#cb124-1" aria-hidden="true" tabindex="-1"></a>env.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(env.z)</span>
<span id="cb124-2"><a href="principal-component-analysis.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(env.pca, scaling = 2)</span></span></code></pre></div>
<p>Determine our subset of <em>Eigenvalues</em> and their corresponding <em>Eigenvectors</em>:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="principal-component-analysis.html#cb125-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="principal-component-analysis.html#cb126-1" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span></code></pre></div>
<pre><code>##      PC1      PC2      PC3 
## 5.968749 2.163818 1.065164</code></pre>
<p><img src="book-en_files/figure-html/unnamed-chunk-84-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The information computed by the PCA can be represented with <em>biplots</em>.</p>
<p>We can produce a <em>quick and dirty</em> biplot of the PCA using the function <code>plot()</code> in base <code>R</code>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="principal-component-analysis.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-85-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>biplot()</code> from <code>base</code> <code>R</code> allows for a better interpretation.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="principal-component-analysis.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-86-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>The arrows are plotted to show the directionality and angle of the descriptors in the ordination.</p>
<ul>
<li>Descriptors at 180 degrees of each other are negatively correlated;</li>
<li>Descriptors at 90 degrees of each other have zero correlation;</li>
<li>Descriptors at 0 degrees of each other are positively correlated.</li>
</ul>
<p><em>Type 2 scaling</em> (<code>default</code>): distances among objects are not approximations of Euclidean distances; angles between descriptor (species) vectors reflect their correlations.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="principal-component-analysis.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-87-1.png" width="432" style="display: block; margin: auto;" /></p>
<p><em>Type 1 scaling</em>: attempts to preserve the Euclidean distance (in multidimensional space) among objects (sites): the angles among descriptor (species) vector are not meaningful.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="principal-component-analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca, <span class="at">scaling =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-88-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
<div id="challenge-2" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Challenge #2<a href="principal-component-analysis.html#challenge-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using everything you have learned, compute a PCA on the mite species abundance data</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="principal-component-analysis.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite)</span></code></pre></div>
<p>Be ready to discuss and answer:</p>
<ul>
<li>What are the <em>most relevant</em> principal components, i.e. subset them?</li>
<li>Which groups of sites can you identify?</li>
<li>Which groups of species are related to these groups of sites?</li>
</ul>
<p><strong>Challenge 2 - Solution</strong> <hidden> Your code likely looks like the following.</p>
<p>Compute PCA on the Hellinger-transformed species data</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="principal-component-analysis.html#cb133-1" aria-hidden="true" tabindex="-1"></a>mite.spe.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(mite, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb133-2"><a href="principal-component-analysis.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="principal-component-analysis.html#cb133-3" aria-hidden="true" tabindex="-1"></a>mite.spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(mite.spe.hel)</span></code></pre></div>
<p>Apply the Kaiser-Guttman criterion</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="principal-component-analysis.html#cb134-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb134-2"><a href="principal-component-analysis.html#cb134-2" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb134-3"><a href="principal-component-analysis.html#cb134-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb134-4"><a href="principal-component-analysis.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Eigenvalues&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb134-5"><a href="principal-component-analysis.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb134-6"><a href="principal-component-analysis.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>,</span>
<span id="cb134-7"><a href="principal-component-analysis.html#cb134-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-92-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="principal-component-analysis.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(mite.spe.h.pca, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red3&quot;</span>, <span class="st">&quot;grey15&quot;</span>))</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-93-1.png" width="672" style="display: block; margin: auto;" /></p>
<p></hidden></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="what-does-unconstrained-mean.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correspondence-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
