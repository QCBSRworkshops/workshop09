<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 13 Analyse en composantes principales | Atelier 9 : Analyses multivariées en R</title>
  <meta name="description" content="Analyses multivariées en R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 13 Analyse en composantes principales | Atelier 9 : Analyses multivariées en R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Analyses multivariées en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 13 Analyse en composantes principales | Atelier 9 : Analyses multivariées en R" />
  
  <meta name="twitter:description" content="Analyses multivariées en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="que-signifie-sans-contrainte.html"/>
<link rel="next" href="analyse-des-correpondances.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Analyses multivariées en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="part"><span><b>PRÉAMBULE</b></span></li>
<li class="chapter" data-level="3" data-path="récapitulatif-analyses-univariées.html"><a href="récapitulatif-analyses-univariées.html"><i class="fa fa-check"></i><b>3</b> Récapitulatif : Analyses univariées</a></li>
<li class="chapter" data-level="4" data-path="intro-analyses-multivariées.html"><a href="intro-analyses-multivariées.html"><i class="fa fa-check"></i><b>4</b> Intro : Analyses multivariées</a></li>
<li class="chapter" data-level="5" data-path="définir-nos-objectifs.html"><a href="définir-nos-objectifs.html"><i class="fa fa-check"></i><b>5</b> Définir nos objectifs</a></li>
<li class="chapter" data-level="6" data-path="lalgèbre-matricielle-très-brièvement.html"><a href="lalgèbre-matricielle-très-brièvement.html"><i class="fa fa-check"></i><b>6</b> L’algèbre matricielle, très brièvement</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lalgèbre-matricielle-très-brièvement.html"><a href="lalgèbre-matricielle-très-brièvement.html#les-ensembles-de-données-sont-des-matrices"><i class="fa fa-check"></i><b>6.1</b> Les ensembles de données <em>sont</em> des matrices</a></li>
<li class="chapter" data-level="6.2" data-path="lalgèbre-matricielle-très-brièvement.html"><a href="lalgèbre-matricielle-très-brièvement.html#matrices-dassociation"><i class="fa fa-check"></i><b>6.2</b> Matrices d’association</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploration-de-lensemble-de-données.html"><a href="exploration-de-lensemble-de-données.html"><i class="fa fa-check"></i><b>7</b> Exploration de l’ensemble de données</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploration-de-lensemble-de-données.html"><a href="exploration-de-lensemble-de-données.html#communautés-de-poissons-du-doubs"><i class="fa fa-check"></i><b>7.1</b> Communautés de poissons du Doubs</a></li>
<li class="chapter" data-level="7.2" data-path="exploration-de-lensemble-de-données.html"><a href="exploration-de-lensemble-de-données.html#données-environnementales-de-la-rivière-doubs"><i class="fa fa-check"></i><b>7.2</b> Données environnementales de la rivière Doubs</a></li>
</ul></li>
<li class="part"><span><b>Mesures d’association</b></span></li>
<li class="chapter" data-level="8" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>8</b> <code>dist()</code></a></li>
<li class="chapter" data-level="9" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html"><i class="fa fa-check"></i><b>9</b> Types de coefficients de distance</a>
<ul>
<li class="chapter" data-level="9.1" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distances-métriques"><i class="fa fa-check"></i><b>9.1</b> Distances métriques</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distances-euclidiennes"><i class="fa fa-check"></i><b>9.1.1</b> Distances euclidiennes</a></li>
<li class="chapter" data-level="9.1.2" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#défi-1"><i class="fa fa-check"></i><b>9.1.2</b> Défi #1</a></li>
<li class="chapter" data-level="9.1.3" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distances-daccord"><i class="fa fa-check"></i><b>9.1.3</b> Distances d’accord</a></li>
<li class="chapter" data-level="9.1.4" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#coefficient-de-jaccard"><i class="fa fa-check"></i><b>9.1.4</b> Coefficient de Jaccard</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distances-semimétriques"><i class="fa fa-check"></i><b>9.2</b> Distances semimétriques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#coefficient-de-sørensen"><i class="fa fa-check"></i><b>9.2.1</b> Coefficient de Sørensen</a></li>
<li class="chapter" data-level="9.2.2" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#coefficient-de-bray-curtis"><i class="fa fa-check"></i><b>9.2.2</b> Coefficient de Bray-Curtis</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distances-non-métriques"><i class="fa fa-check"></i><b>9.3</b> Distances non métriques</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#distance-de-mahalanobis"><i class="fa fa-check"></i><b>9.3.1</b> Distance de Mahalanobis</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="types-de-coefficients-de-distance.html"><a href="types-de-coefficients-de-distance.html#représentation-des-matrices-de-distance"><i class="fa fa-check"></i><b>9.4</b> Représentation des matrices de distance</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>10</b> Transformations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transformations.html"><a href="transformations.html#transformation-présence-absence"><i class="fa fa-check"></i><b>10.1</b> Transformation présence-absence</a></li>
<li class="chapter" data-level="10.2" data-path="transformations.html"><a href="transformations.html#transformation-des-profils-despèces"><i class="fa fa-check"></i><b>10.2</b> Transformation des profils d’espèces</a></li>
<li class="chapter" data-level="10.3" data-path="transformations.html"><a href="transformations.html#transformation-de-hellinger"><i class="fa fa-check"></i><b>10.3</b> Transformation de Hellinger</a></li>
<li class="chapter" data-level="10.4" data-path="transformations.html"><a href="transformations.html#normalisation-par-le-score-z"><i class="fa fa-check"></i><b>10.4</b> Normalisation par le score Z</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="transformations.html"><a href="transformations.html#autres-métriques-dassociation"><i class="fa fa-check"></i><b>10.4.1</b> Autres métriques d’association</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Clustering</b></span></li>
<li class="chapter" data-level="11" data-path="regroupement.html"><a href="regroupement.html"><i class="fa fa-check"></i><b>11</b> Regroupement</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regroupement.html"><a href="regroupement.html#regroupement-agglomératif-à-lien-unique"><i class="fa fa-check"></i><b>11.1</b> Regroupement agglomératif à lien unique</a></li>
<li class="chapter" data-level="11.2" data-path="regroupement.html"><a href="regroupement.html#regroupement-agglomératif-à-liens-complets"><i class="fa fa-check"></i><b>11.2</b> Regroupement agglomératif à liens complets</a></li>
<li class="chapter" data-level="11.3" data-path="regroupement.html"><a href="regroupement.html#méthode-des-groupes-de-paires-non-pondérés-avec-moyenne-arithmétique-upgma"><i class="fa fa-check"></i><b>11.3</b> Méthode des groupes de paires non pondérés avec moyenne arithmétique (UPGMA)</a></li>
<li class="chapter" data-level="11.4" data-path="regroupement.html"><a href="regroupement.html#méthode-des-groupes-de-paires-pondérés-avec-moyenne-arithmétique-wpgma"><i class="fa fa-check"></i><b>11.4</b> Méthode des groupes de paires pondérés avec moyenne arithmétique (WPGMA)</a></li>
<li class="chapter" data-level="11.5" data-path="regroupement.html"><a href="regroupement.html#variance-minimale-de-ward"><i class="fa fa-check"></i><b>11.5</b> Variance minimale de Ward</a></li>
<li class="chapter" data-level="11.6" data-path="regroupement.html"><a href="regroupement.html#décider-des-points-de-coupure"><i class="fa fa-check"></i><b>11.6</b> Décider des points de coupure</a></li>
<li class="chapter" data-level="11.7" data-path="regroupement.html"><a href="regroupement.html#jouer-avec-des-données-réelles-les-données-sur-les-espèces-de-poissons-du-doubs"><i class="fa fa-check"></i><b>11.7</b> Jouer avec des données réelles : les données sur les espèces de poissons du Doubs</a></li>
</ul></li>
<li class="part"><span><b>L’Ordination sans contrainte</b></span></li>
<li class="chapter" data-level="12" data-path="que-signifie-sans-contrainte.html"><a href="que-signifie-sans-contrainte.html"><i class="fa fa-check"></i><b>12</b> Que signifie “sans contrainte” ?</a></li>
<li class="chapter" data-level="13" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html"><i class="fa fa-check"></i><b>13</b> Analyse en composantes principales</a>
<ul>
<li class="chapter" data-level="13.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#lanalyse-en-composantes-principales-pas-en-bref"><i class="fa fa-check"></i><b>13.1</b> L’analyse en composantes principales <em>pas</em> en bref</a></li>
<li class="chapter" data-level="13.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales-à-laide-des-fonctions-du-paquet"><i class="fa fa-check"></i><b>13.2</b> Analyse en composantes principales à l’aide des fonctions du paquet</a></li>
<li class="chapter" data-level="13.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales-sur-des-données-écologiques"><i class="fa fa-check"></i><b>13.3</b> Analyse en composantes principales sur des données écologiques</a></li>
<li class="chapter" data-level="13.4" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#condenser-les-données-avec-lanalyse-en-composantes-principales"><i class="fa fa-check"></i><b>13.4</b> Condenser les données avec l’analyse en composantes principales</a></li>
<li class="chapter" data-level="13.5" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#échelonnement"><i class="fa fa-check"></i><b>13.5</b> Échelonnement</a></li>
<li class="chapter" data-level="13.6" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#défi-2"><i class="fa fa-check"></i><b>13.6</b> Défi #2</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="analyse-des-correpondances.html"><a href="analyse-des-correpondances.html"><i class="fa fa-check"></i><b>14</b> Analyse des Correpondances</a></li>
<li class="chapter" data-level="15" data-path="analyse-en-coordonnées-principales.html"><a href="analyse-en-coordonnées-principales.html"><i class="fa fa-check"></i><b>15</b> Analyse en coordonnées principales</a></li>
<li class="chapter" data-level="16" data-path="positionnement-multidimensionnel-non-métrique.html"><a href="positionnement-multidimensionnel-non-métrique.html"><i class="fa fa-check"></i><b>16</b> Positionnement multidimensionnel non-métrique</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="17" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>17</b> Sommaire</a></li>
<li class="chapter" data-level="18" data-path="resources-additionnels.html"><a href="resources-additionnels.html"><i class="fa fa-check"></i><b>18</b> Resources additionnels</a></li>
<li class="chapter" data-level="19" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>19</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 9 : Analyses multivariées en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="analyse-en-composantes-principales" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapitre 13</span> Analyse en composantes principales<a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>L’analyse en composantes principales (ACP) est une technique statistique utilisée pour réduire la dimensionnalité d’un ensemble de données tout en conservant la majeure partie de sa variabilité. variabilité. Il s’agit d’une méthode de transformation linéaire qui convertit l’ensemble de variables d’origine en un nouvel ensemble de variables linéairement non corrélées. l’ensemble original de variables en un nouvel ensemble de variables linéairement non corrélées, appelées linéairement non corrélées, appelées composantes principales (CP), qui sont classées par ordre décroissant de variance. par ordre décroissant de variance.</p>
<p>L’ACP a été introduite pour la première fois par Karl Pearson en 1901, qui a développé les fondements mathématiques de la méthode. les fondements mathématiques de la méthode. Plus tard, Harold Hotelling (1933) a fourni une interprétation plus détaillée et plus moderne de la méthode ACP.</p>
<p>L’ACP est devenue l’une des techniques les plus utilisées dans l’analyse des données données en raison de sa capacité à identifier des modèles cachés et à réduire la complexité des données à haute dimension.</p>
<p>En substance, l’ACP vise à trouver les combinaisons linéaires des variables qui représentent la plus grande quantité possible de variation dans l’ensemble l’ensemble des données. Les composantes principales qui en résultent sont orthogonales les unes par rapport aux autres, ce qui signifie qu’elles ne sont pas corrélées entre elles. orthogonales, ce qui signifie qu’elles ne sont pas corrélées. leur importance dans l’explication de la variabilité des données.</p>
<p>Pour vous familiariser avec l’ACP, nous allons suivre des exemples détaillés sur la façon de l’exécuter étape par étape. comment l’effectuer étape par étape, puis nous utiliserons les fonctions des paquets R pour la réaliser.</p>
<div id="lanalyse-en-composantes-principales-pas-en-bref" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> L’analyse en composantes principales <em>pas</em> en bref<a href="analyse-en-composantes-principales.html#lanalyse-en-composantes-principales-pas-en-bref" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Supposons que nous ayons un ensemble de données avec <span class="math inline">\(n\)</span> observations et <span class="math inline">\(p\)</span> variables représentées par une matrice n x p <span class="math inline">\(X\)</span>. L’objectif de l’ACP est de transformer cet ensemble de en un nouvel ensemble de <span class="math inline">\(p\)</span> variables non corrélées, appelées composantes principales composantes principales (CP), qui capturent le maximum de variance dans les données originales. données originales.</p>
<div id="charger-les-données" class="section level4 hasAnchor" number="13.1.0.1">
<h4><span class="header-section-number">13.1.0.1</span> Charger les données<a href="analyse-en-composantes-principales.html#charger-les-données" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans cet atelier, nous utilisons le jeu de données <code>data(varechem)</code>, qui contient des des mesures des propriétés chimiques de 18 échantillons de sol provenant d’une d’une expérience sur le terrain. Nous sélectionnerons les deux premières variables :</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="analyse-en-composantes-principales.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement du paquet datasets</span></span>
<span id="cb95-2"><a href="analyse-en-composantes-principales.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb95-3"><a href="analyse-en-composantes-principales.html#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="analyse-en-composantes-principales.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger le jeu de données varechem</span></span>
<span id="cb95-5"><a href="analyse-en-composantes-principales.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)</span>
<span id="cb95-6"><a href="analyse-en-composantes-principales.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="analyse-en-composantes-principales.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélectionner les données</span></span>
<span id="cb95-8"><a href="analyse-en-composantes-principales.html#cb95-8" aria-hidden="true" tabindex="-1"></a>(data <span class="ot">&lt;-</span> varechem[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div>
<pre><code>##       N    P
## 18 19.8 42.1
## 15 13.4 39.1
## 24 20.2 67.7
## 27 20.6 60.8
## 23 23.8 54.5
## 19 22.8 40.9
## 22 26.6 36.7
## 16 24.2 31.0
## 28 29.8 73.5
## 13 28.1 40.5
## 14 21.8 38.1
## 20 26.2 61.9
## 25 22.8 50.6
## 7  30.5 24.6
## 5  33.1 22.7
## 6  19.1 26.4
## 3  31.1 32.3
## 4  18.0 64.9
## 2  22.3 47.4
## 9  15.0 48.4
## 12 16.0 32.7
## 10 14.3 62.8
## 11 16.7 55.8
## 21 21.0 26.5</code></pre>
</div>
<div id="normaliser-les-données" class="section level4 hasAnchor" number="13.1.0.2">
<h4><span class="header-section-number">13.1.0.2</span> Normaliser les données<a href="analyse-en-composantes-principales.html#normaliser-les-données" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous devons d’abord normaliser les données pour qu’elles aient une moyenne nulle et une variance unitaire :</p>
<p><span class="math display">\[ Z_{ij} = \frac{X_{ij} - \bar{X_j}}{s_j} \]</span></p>
<p>où Z est la matrice standardisée, X est la matrice originale, <span class="math inline">\(\bar{X_j}\)</span> est la moyenne de la variable j, et <span class="math inline">\(s_j\)</span> est l’écart-type de la variable j.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="analyse-en-composantes-principales.html#cb97-1" aria-hidden="true" tabindex="-1"></a>data_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(data)</span></code></pre></div>
</div>
<div id="calculer-la-matrice-de-covariance" class="section level4 hasAnchor" number="13.1.0.3">
<h4><span class="header-section-number">13.1.0.3</span> Calculer la matrice de covariance<a href="analyse-en-composantes-principales.html#calculer-la-matrice-de-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ensuite, nous calculons la matrice de covariance de <span class="math inline">\(Z\)</span> :</p>
<p><span class="math display">\[ C = \frac{1}{n-1}ZZ^T \]</span></p>
<p>où <span class="math inline">\(C\)</span> est la matrice de covariance et <span class="math inline">\(T\)</span> représente l’opération de transposition.</p>
<p>La matrice de covariance est une matrice symétrique qui représente les covariances par paire entre les variables. La formule de la covariance entre deux variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> est la suivante :</p>
<p><span class="math display">\[\text{Cov}(X,Y) = \frac{1}{n-1}\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})\]</span></p>
<p>où <span class="math inline">\(n\)</span> est la taille de l’échantillon, <span class="math inline">\(X_i\)</span> et <span class="math inline">\(Y_i\)</span> sont les valeurs des variables pour l’observation $i$, et <span class="math inline">\(\bar{X}\)</span> et <span class="math inline">\(\bar{Y}\)</span> sont les moyennes de l’échantillon des variables.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="analyse-en-composantes-principales.html#cb98-1" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(data_std)</span></code></pre></div>
</div>
<div id="effectuer-la-décomposition-en-valeurs-propres-de-la-matrice-de-covariance" class="section level4 hasAnchor" number="13.1.0.4">
<h4><span class="header-section-number">13.1.0.4</span> Effectuer la décomposition en valeurs propres de la matrice de covariance<a href="analyse-en-composantes-principales.html#effectuer-la-décomposition-en-valeurs-propres-de-la-matrice-de-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ensuite, nous calculons les valeurs propres et les vecteurs propres de <span class="math inline">\(C\)</span> :</p>
<p><span class="math display">\[ Cv = \lambda v \]</span></p>
<p>où <span class="math inline">\(C\)</span> est la matrice de covariance, <span class="math inline">\(v\)</span> est le vecteur propre et <span class="math inline">\(\lambda\)</span> est la valeur propre correspondante.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="analyse-en-composantes-principales.html#cb99-1" aria-hidden="true" tabindex="-1"></a>eigen_decomp <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_matrix)</span>
<span id="cb99-2"><a href="analyse-en-composantes-principales.html#cb99-2" aria-hidden="true" tabindex="-1"></a>Eigenvalues <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>values</span>
<span id="cb99-3"><a href="analyse-en-composantes-principales.html#cb99-3" aria-hidden="true" tabindex="-1"></a>Eigenvectors <span class="ot">&lt;-</span> eigen_decomp<span class="sc">$</span>vectors</span></code></pre></div>
<p>Les vecteurs propres représentent les directions dans l’espace à <span class="math inline">\(p\)</span> dimensions qui capturent le maximum de variance dans les données, et les valeurs propres indiquent la quantité de variance capturée par chaque vecteur propre.</p>
</div>
<div id="projeter-les-données-normalisées-sur-lespace-des-valeurs-propres" class="section level4 hasAnchor" number="13.1.0.5">
<h4><span class="header-section-number">13.1.0.5</span> Projeter les données normalisées sur l’espace des valeurs propres<a href="analyse-en-composantes-principales.html#projeter-les-données-normalisées-sur-lespace-des-valeurs-propres" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Enfin, nous projetons la matrice de données normalisées <span class="math inline">\(Z\)</span> sur les nouveaux vecteurs de base pour obtenir les composantes principales. Ici, nous calculons les scores des composantes principales en multipliant les données normalisées par les vecteurs propres de toutes les composantes principales :</p>
<p><span class="math display">\[ Y = ZV \]</span></p>
<p>où <span class="math inline">\(Y\)</span> est la matrice des données transformées et <span class="math inline">\(V\)</span> est la matrice des vecteurs propres.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="analyse-en-composantes-principales.html#cb100-1" aria-hidden="true" tabindex="-1"></a>F_PrComps <span class="ot">&lt;-</span> data_std <span class="sc">%*%</span> Eigenvectors</span>
<span id="cb100-2"><a href="analyse-en-composantes-principales.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="analyse-en-composantes-principales.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(F_PrComps)</span></code></pre></div>
<pre><code>##          [,1]       [,2]
## 18  0.1894957  0.4713816
## 15  0.8662023  1.4319452
## 24  1.3494546 -0.7909067
## 27  0.9718543 -0.5156358
## 23  0.2644868 -0.6269034
## 19 -0.2510109  0.1444178</code></pre>
<p>La matrice de score, <span class="math inline">\(F\)</span>, (objet <code>F_PrComps</code>) permet de <em>rotationner</em> le nouvel espace de données, de sorte qu’il soit représenté par rapport aux composantes principales. Par exemple, voir la figure ci-dessous :</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-63"></span>
<img src="book-fr_files/figure-html/unnamed-chunk-63-1.png" alt="Relation entre N et P à partir de l'ensemble de données `varechem`. Les lignes diagonales violette et orange représentent respectivement la première et la deuxième composante principale. Les lignes violettes indiquent les résidus entre le point de données et la première composante principale, tandis que les lignes orange segmentées indiquent la distance entre les points et la deuxième composante principale. Les flèches indiquent les valeurs propres (direction) de l'analyse en composantes principales effectuée sur ces deux variables." width="336" />
<p class="caption">
Figure 13.1: Relation entre N et P à partir de l’ensemble de données <code>varechem</code>. Les lignes diagonales violette et orange représentent respectivement la première et la deuxième composante principale. Les lignes violettes indiquent les résidus entre le point de données et la première composante principale, tandis que les lignes orange segmentées indiquent la distance entre les points et la deuxième composante principale. Les flèches indiquent les valeurs propres (direction) de l’analyse en composantes principales effectuée sur ces deux variables.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-64"></span>
<img src="book-fr_files/figure-html/unnamed-chunk-64-1.png" alt="Relation entre PC1 et PC2 de l'analyse en composantes principales effectuée sur les variables P et N de l'ensemble de données `varechem`. Les lignes violettes et orange représentent respectivement la première et la deuxième composante principale. Les lignes violettes indiquent les résidus entre le point de données et la première composante principale, tandis que les lignes orange segmentées indiquent la distance entre les points et la deuxième composante principale." width="336" />
<p class="caption">
Figure 13.2: Relation entre PC1 et PC2 de l’analyse en composantes principales effectuée sur les variables P et N de l’ensemble de données <code>varechem</code>. Les lignes violettes et orange représentent respectivement la première et la deuxième composante principale. Les lignes violettes indiquent les résidus entre le point de données et la première composante principale, tandis que les lignes orange segmentées indiquent la distance entre les points et la deuxième composante principale.
</p>
</div>
</div>
</div>
<div id="analyse-en-composantes-principales-à-laide-des-fonctions-du-paquet" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Analyse en composantes principales à l’aide des fonctions du paquet<a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales-à-laide-des-fonctions-du-paquet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’ACP peut également être calculée en utilisant les fonctions <code>stats::prcomp()</code>, <code>stats::princomp()</code>, <code>vegan::rda()</code>, et <code>ade4::dudi.pca()</code>.</p>
<p>En résumé, voici ce que nous avons fait :</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="analyse-en-composantes-principales.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(varechem)</span>
<span id="cb102-2"><a href="analyse-en-composantes-principales.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="analyse-en-composantes-principales.html#cb102-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> varechem[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb102-4"><a href="analyse-en-composantes-principales.html#cb102-4" aria-hidden="true" tabindex="-1"></a>Y_std <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(Y))</span>
<span id="cb102-5"><a href="analyse-en-composantes-principales.html#cb102-5" aria-hidden="true" tabindex="-1"></a>Y_R <span class="ot">&lt;-</span> <span class="fu">cov</span>(Y_std)</span>
<span id="cb102-6"><a href="analyse-en-composantes-principales.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="analyse-en-composantes-principales.html#cb102-7" aria-hidden="true" tabindex="-1"></a>Eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Y_R)<span class="sc">$</span>values</span>
<span id="cb102-8"><a href="analyse-en-composantes-principales.html#cb102-8" aria-hidden="true" tabindex="-1"></a>Eigenvectors <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Y_R)<span class="sc">$</span>vectors</span>
<span id="cb102-9"><a href="analyse-en-composantes-principales.html#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="analyse-en-composantes-principales.html#cb102-10" aria-hidden="true" tabindex="-1"></a>F_PrComps <span class="ot">&lt;-</span> Y_std <span class="sc">%*%</span> Eigenvectors</span>
<span id="cb102-11"><a href="analyse-en-composantes-principales.html#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="analyse-en-composantes-principales.html#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(F_PrComps)</span></code></pre></div>
<pre><code>##          [,1]       [,2]
## 18  0.1894957  0.4713816
## 15  0.8662023  1.4319452
## 24  1.3494546 -0.7909067
## 27  0.9718543 -0.5156358
## 23  0.2644868 -0.6269034
## 19 -0.2510109  0.1444178</code></pre>
<p>Comment cela se compare-t-il à <code>stats::prcomp()</code> ?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="analyse-en-composantes-principales.html#cb104-1" aria-hidden="true" tabindex="-1"></a>PCA_prcomp <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(Y, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-2"><a href="analyse-en-composantes-principales.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="analyse-en-composantes-principales.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or PCA_prcomp &lt;- prcomp(Y_std)</span></span>
<span id="cb104-4"><a href="analyse-en-composantes-principales.html#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="analyse-en-composantes-principales.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PCA_prcomp<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>##           PC1        PC2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034
## 19  0.2510109 -0.1444178</code></pre>
<p>Et quelle est la comparaison avec <code>stats::princomp()</code> ?</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="analyse-en-composantes-principales.html#cb106-1" aria-hidden="true" tabindex="-1"></a>PCA_princomp <span class="ot">&lt;-</span> <span class="fu">princomp</span>(Y_std)</span>
<span id="cb106-2"><a href="analyse-en-composantes-principales.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="analyse-en-composantes-principales.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PCA_princomp<span class="sc">$</span>scores)</span></code></pre></div>
<pre><code>##        Comp.1     Comp.2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034
## 19  0.2510109 -0.1444178</code></pre>
<p>Et avec <code>vegan::rda()</code>?</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="analyse-en-composantes-principales.html#cb108-1" aria-hidden="true" tabindex="-1"></a>PCA_vegan_rda <span class="ot">&lt;-</span> <span class="fu">rda</span>(Y_std)</span>
<span id="cb108-2"><a href="analyse-en-composantes-principales.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="analyse-en-composantes-principales.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scores</span>(PCA_vegan_rda, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">choices =</span> <span class="fu">seq_len</span>(PCA_vegan_rda<span class="sc">$</span>CA<span class="sc">$</span>rank),</span>
<span id="cb108-4"><a href="analyse-en-composantes-principales.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const =</span> <span class="fu">sqrt</span>(PCA_vegan_rda<span class="sc">$</span>tot.chi <span class="sc">*</span> (<span class="fu">nrow</span>(PCA_vegan_rda<span class="sc">$</span>CA<span class="sc">$</span>u) <span class="sc">-</span></span>
<span id="cb108-5"><a href="analyse-en-composantes-principales.html#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>)))[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>##           PC1        PC2
## 18 -0.1894957 -0.4713816
## 15 -0.8662023 -1.4319452
## 24 -1.3494546  0.7909067
## 27 -0.9718543  0.5156358
## 23 -0.2644868  0.6269034</code></pre>
<p><code>vegan::rda()</code> est un peu spéciale. Elle utilise des échelles alternatives. Nous ne les aborderons pas ici, mais vous pouvez étudier la <code>vignette("decision-vegan")</code>.</p>
</div>
<div id="analyse-en-composantes-principales-sur-des-données-écologiques" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Analyse en composantes principales sur des données écologiques<a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales-sur-des-données-écologiques" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous avons mis en œuvre l’ACP sur un ensemble de données à deux variables, pour des raisons de simplicité.</p>
<p>Avançons et appliquons-la à notre jeu de données sur les espèces de poissons.</p>
<p>Pour cela, nous allons utiliser la fonction <code>vegan::rda()</code> sur les données de poissons <em>transformées par Hellinger</em> et résumer les résultats :</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="analyse-en-composantes-principales.html#cb110-1" aria-hidden="true" tabindex="-1"></a>spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(spe.hel)</span>
<span id="cb110-2"><a href="analyse-en-composantes-principales.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="analyse-en-composantes-principales.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(spe.h.pca)</span></span></code></pre></div>
<p>Les premières lignes de <code>summary.rda()</code> nous renseignent sur la <em>variance totale</em> et la <em>variance non contrainte</em> de notre modèle.</p>
<p>``{r echo=FALSE}
paste(capture.output(summary(spe.h.pca))[5:8])</p>
<pre><code>
``{r echo=FALSE}
paste(capture.output(summary(spe.h.pca))[c(12:16, 21:24)])</code></pre>
<p>Viennent ensuite les <em>valeurs propres</em> et leur contribution à la variance.</p>
<p>En fait, si nous additionnons toutes nos <em>valeurs propres</em>, nous obtiendrons la quantité de variance non contrainte expliquée par l’analyse !</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="analyse-en-composantes-principales.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig)</span></code></pre></div>
<pre><code>## [1] 0.5023429</code></pre>
<p>Les informations suivantes sont liées à l’<em>échelle</em>, aux <em>scores d’espèces</em> et aux <em>scores de sites</em>.</p>
<pre><code>##  [1] &quot;Eigenvalue            0.0004263 0.0002812 0.0002188 0.0001382 0.0000876&quot;
##  [2] &quot;Proportion Explained  0.0008487 0.0005598 0.0004356 0.0002752 0.0001744&quot;
##  [3] &quot;Cumulative Proportion 0.9984010 0.9989608 0.9993965 0.9996717 0.9998460&quot;
##  [4] &quot;                           PC25      PC26      PC27&quot;                    
##  [5] &quot;Proportion Explained  1.062e-04 2.938e-05 1.835e-05&quot;                    
##  [6] &quot;Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00&quot;                    
##  [7] &quot;Scaling 2 for species and site scores&quot;                                  
##  [8] &quot;* Species are scaled proportional to eigenvalues&quot;                       
##  [9] &quot;* Sites are unscaled: weighted dispersion equal on all dimensions&quot;      
## [10] &quot;* General scaling constant of scores:  1.953663 &quot;                       
## [11] &quot;&quot;                                                                       
## [12] &quot;&quot;                                                                       
## [13] &quot;Species scores&quot;                                                         
## [14] &quot;BCO -0.20055  0.08332 -0.074787 -0.0504875  0.073890  0.0249842&quot;        
## [15] &quot;PCH -0.14626  0.05268 -0.072012 -0.0432572  0.050318  0.0178776&quot;        
## [16] &quot;GAR -0.35085 -0.09353  0.198664  0.0178669  0.023796 -0.0971362&quot;        
## [17] &quot;BBO -0.24167  0.03598 -0.079528 -0.0339049  0.096690  0.0620979&quot;        
## [18] &quot;ABL -0.42269 -0.22879  0.007158  0.1128353  0.006759  0.1248913&quot;        
## [19] &quot;ANG -0.20521  0.11557 -0.072060 -0.0159902  0.072030 -0.0003801&quot;        
## [20] &quot;&quot;                                                                       
## [21] &quot;&quot;                                                                       
## [22] &quot;Site scores (weighted sums of species scores)&quot;</code></pre>
<p>Les <em>espèces</em> font référence à vos descripteurs (c’est-à-dire les colonnes de votre jeu de données), qui sont ici les espèces de poissons.</p>
<p>Les <em>scores</em> font référence à la position de chaque espèce le long des composantes principales.</p>
<pre><code>## [1] &quot;Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00&quot;              
## [2] &quot;Scaling 2 for species and site scores&quot;                            
## [3] &quot;* Species are scaled proportional to eigenvalues&quot;                 
## [4] &quot;* Sites are unscaled: weighted dispersion equal on all dimensions&quot;
## [5] &quot;* General scaling constant of scores:  1.953663 &quot;                 
## [6] &quot;&quot;                                                                 
## [7] &quot;&quot;                                                                 
## [8] &quot;Species scores&quot;</code></pre>
<pre><code>## [1] &quot;PCH -0.14626  0.05268 -0.072012 -0.0432572  0.050318  0.0178776&quot;
## [2] &quot;GAR -0.35085 -0.09353  0.198664  0.0178669  0.023796 -0.0971362&quot;
## [3] &quot;BBO -0.24167  0.03598 -0.079528 -0.0339049  0.096690  0.0620979&quot;
## [4] &quot;ABL -0.42269 -0.22879  0.007158  0.1128353  0.006759  0.1248913&quot;
## [5] &quot;ANG -0.20521  0.11557 -0.072060 -0.0159902  0.072030 -0.0003801&quot;
## [6] &quot;&quot;                                                               
## [7] &quot;&quot;                                                               
## [8] &quot;Site scores (weighted sums of species scores)&quot;</code></pre>
<p><em>Sites</em> représente les lignes de votre jeu de données, qui sont ici les différents sites le long de la rivière <em>Doubs</em>.</p>
<p>Cette information peut être obtenue avec la fonction <code>score()</code> que nous avons utilisée précédemment :</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="analyse-en-composantes-principales.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scores</span>(spe.h.pca,</span>
<span id="cb117-2"><a href="analyse-en-composantes-principales.html#cb117-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">display =</span> <span class="st">&quot;species&quot;</span> or <span class="st">&quot;sites&quot;</span>)</span></code></pre></div>
</div>
<div id="condenser-les-données-avec-lanalyse-en-composantes-principales" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Condenser les données avec l’analyse en composantes principales<a href="analyse-en-composantes-principales.html#condenser-les-données-avec-lanalyse-en-composantes-principales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ici, nous avons 27 composantes principales. Cependant, nous pouvons appliquer des algorithmes pour sélectionner le plus petit nombre de composantes principales qui rendent encore compte d’une grande variance dans les données.</p>
<div id="critère-de-kaiser-guttman" class="section level4 hasAnchor" number="13.4.0.1">
<h4><span class="header-section-number">13.4.0.1</span> Critère de Kaiser-Guttman<a href="analyse-en-composantes-principales.html#critère-de-kaiser-guttman" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous pouvons sélectionner les composantes principales qui capturent plus de variance que l’explication moyenne de toutes les composantes principales. Pour ce faire, nous procédons comme suit</p>
<ol style="list-style-type: decimal">
<li><p>Extraire les <em>valeurs propres</em> associées aux composantes principales ;</p></li>
<li><p>Sous-ensemble des <em>valeurs propres</em> supérieures à la <em>valeur propre</em> moyenne :</p></li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="analyse-en-composantes-principales.html#cb118-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb118-2"><a href="analyse-en-composantes-principales.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ev[ev &gt; mean(ev)]</span></span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="analyse-en-composantes-principales.html#cb119-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb119-2"><a href="analyse-en-composantes-principales.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb119-3"><a href="analyse-en-composantes-principales.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb119-4"><a href="analyse-en-composantes-principales.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Average eigenvalue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>,</span>
<span id="cb119-5"><a href="analyse-en-composantes-principales.html#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-76-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="modèle-à-bâtons-rompus" class="section level4 hasAnchor" number="13.4.0.2">
<h4><span class="header-section-number">13.4.0.2</span> Modèle à bâtons rompus<a href="analyse-en-composantes-principales.html#modèle-à-bâtons-rompus" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le modèle à bâtons (ou branches) rompus retient les composantes qui expliquent plus de variance que ce que l’on pourrait attendre en divisant aléatoirement la variance en <span class="math inline">\(p\)</span> parties.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="analyse-en-composantes-principales.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">bstick</span>(spe.h.pca))</span></code></pre></div>
<pre><code>##        PC1        PC2        PC3        PC4        PC5        PC6 
## 0.07240169 0.05379640 0.04449375 0.03829199 0.03364067 0.02991961</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="analyse-en-composantes-principales.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(spe.h.pca, <span class="at">bstick =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;lines&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-78-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="échelonnement" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Échelonnement<a href="analyse-en-composantes-principales.html#échelonnement" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il ne nous reste plus qu’à discuter de la <em>mise à l’échelle</em> et à <em>visualiser</em> nos résultats.</p>
<p>Pratiquons et calculons une ACP sur les variables environnementales standardisées pour le même ensemble de données.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="analyse-en-composantes-principales.html#cb123-1" aria-hidden="true" tabindex="-1"></a>env.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(env.z)</span>
<span id="cb123-2"><a href="analyse-en-composantes-principales.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(env.pca, scaling = 2)</span></span></code></pre></div>
<p>Déterminer notre sous-ensemble de <em>valeurs propres</em> et leurs <em>vecteurs propres</em> correspondants :</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="analyse-en-composantes-principales.html#cb124-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> env.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="analyse-en-composantes-principales.html#cb125-1" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span></code></pre></div>
<pre><code>##      PC1      PC2      PC3 
## 5.968749 2.163818 1.065164</code></pre>
<p><img src="book-fr_files/figure-html/unnamed-chunk-82-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Les informations calculées par l’ACP peuvent être représentées par des <em>biplots</em>.</p>
<p>Nous pouvons produire un <em>biplot simple et rapide</em> de l’ACP en utilisant la fonction <code>plot()</code> dans la base <code>R</code>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="analyse-en-composantes-principales.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.h.pca)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-83-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>biplot()</code> de <code>base</code> <code>R</code> permet une meilleure interprétation.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="analyse-en-composantes-principales.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-84-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>Les flèches sont tracées pour montrer la directionnalité et l’angle des descripteurs dans l’ordination.</p>
<ul>
<li>Les descripteurs situés à 180 degrés les uns des autres sont négativement corrélés ;</li>
<li>Les descripteurs situés à 90 degrés les uns des autres ont une corrélation nulle ;</li>
<li>Les descripteurs situés à 0 degré les uns des autres sont positivement corrélés.</li>
</ul>
<p><em>Échelle de type 2</em> (par défaut) : les distances entre les objets ne sont pas des approximations des distances euclidiennes ; les angles entre les vecteurs des descripteurs (espèces) reflètent leurs corrélations.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="analyse-en-composantes-principales.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-85-1.png" width="432" style="display: block; margin: auto;" /></p>
<p><em>Échelle de type 1</em> : tente de préserver la distance euclidienne (dans l’espace multidimensionnel) entre les objets (sites) : les angles entre les vecteurs des descripteurs (espèces) ne sont pas significatifs.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="analyse-en-composantes-principales.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(spe.h.pca, <span class="at">scaling =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-86-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
<div id="défi-2" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Défi #2<a href="analyse-en-composantes-principales.html#défi-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En utilisant tout ce que vous avez appris, calculez une ACP sur les données d’abondance des espèces d’acariens</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="analyse-en-composantes-principales.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite)</span></code></pre></div>
<p>Préparez-vous à discuter et à répondre :</p>
<ul>
<li>Quelles sont les composantes principales les plus pertinentes, c’est-à-dire les sous-ensembles ?</li>
<li>Quels groupes de sites pouvez-vous identifier ?</li>
<li>Quels groupes d’espèces sont liés à ces groupes de sites ?</li>
</ul>
<p><strong>Défi 2 - Solution</strong> <hidden> Votre code ressemble probablement à ce qui suit.</p>
<p>Calculer l’ACP sur les données d’espèces transformées par Hellinger</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="analyse-en-composantes-principales.html#cb132-1" aria-hidden="true" tabindex="-1"></a>mite.spe.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(mite, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb132-2"><a href="analyse-en-composantes-principales.html#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="analyse-en-composantes-principales.html#cb132-3" aria-hidden="true" tabindex="-1"></a>mite.spe.h.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(mite.spe.hel)</span></code></pre></div>
<p>Appliquer le critère de Kaiser-Guttman</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="analyse-en-composantes-principales.html#cb133-1" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> mite.spe.h.pca<span class="sc">$</span>CA<span class="sc">$</span>eig</span>
<span id="cb133-2"><a href="analyse-en-composantes-principales.html#cb133-2" aria-hidden="true" tabindex="-1"></a>ev[ev <span class="sc">&gt;</span> <span class="fu">mean</span>(ev)]</span>
<span id="cb133-3"><a href="analyse-en-composantes-principales.html#cb133-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ev)</span>
<span id="cb133-4"><a href="analyse-en-composantes-principales.html#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ev, <span class="at">main =</span> <span class="st">&quot;Valeurs propres&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb133-5"><a href="analyse-en-composantes-principales.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ev), <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb133-6"><a href="analyse-en-composantes-principales.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Valeur propre moyenne&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red3&quot;</span>,</span>
<span id="cb133-7"><a href="analyse-en-composantes-principales.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-90-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="analyse-en-composantes-principales.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(mite.spe.h.pca, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red3&quot;</span>, <span class="st">&quot;grey15&quot;</span>))</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-91-1.png" width="672" style="display: block; margin: auto;" /></p>
<p></hidden></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="que-signifie-sans-contrainte.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyse-des-correpondances.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
